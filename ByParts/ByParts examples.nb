(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    130166,       3317]
NotebookOptionsPosition[    123304,       3103]
NotebookOutlinePosition[    125238,       3154]
CellTagsIndexPosition[    125195,       3151]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["ByParts example file", "Title",
 CellChangeTimes->{{3.614065866263702*^9, 3.614065874362432*^9}, {
  3.616750585954349*^9, 3.6167505942122307`*^9}}],

Cell["\<\
This is the example file for the lightweight ByParts package which provides \
the user with additional functions that easily perform integrations by parts \
subject to vanishing boundary terms.
The ByParts package is built upon the xTensor package, part of the xAct suite.\
\>", "Text",
 CellChangeTimes->{{3.61406602807123*^9, 3.614066085333939*^9}, {
  3.616750599397168*^9, 3.616750741519402*^9}, {3.616753887397778*^9, 
  3.616753912013541*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", " ", "xAct`ByParts`"}]], "Input",
 CellChangeTimes->{{3.612251099044189*^9, 3.612251113906559*^9}, {
   3.6122512424398623`*^9, 3.612251242606992*^9}, {3.612251298462688*^9, 
   3.612251303895104*^9}, {3.612765089363844*^9, 3.61276509102744*^9}, 
   3.612767715821713*^9, {3.612767751100121*^9, 3.612767751980509*^9}, {
   3.612850768304447*^9, 3.612850780210713*^9}, {3.612854239338798*^9, 
   3.612854249226185*^9}, {3.612866897892571*^9, 3.612866904132704*^9}, {
   3.612867437045236*^9, 3.612867438529931*^9}, {3.613192441505775*^9, 
   3.613192447633793*^9}, {3.613298469387096*^9, 3.613298471888612*^9}, {
   3.613383341587882*^9, 3.613383344230342*^9}, {3.613474037402286*^9, 
   3.613474056149808*^9}, {3.613708631004551*^9, 3.613708633578704*^9}, {
   3.6140659957175293`*^9, 3.614065995976239*^9}, 3.614066352142624*^9, {
   3.6140664082022467`*^9, 3.6140664082035646`*^9}, {3.614068132642098*^9, 
   3.614068140213666*^9}, {3.616752398045974*^9, 3.616752401387507*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.6167538400554867`*^9, {3.616840834723184*^9, 3.616840861114718*^9}, 
   3.616840907025504*^9, 3.6168409605595093`*^9, 3.617185707035488*^9, {
   3.617364214833828*^9, 3.617364267253875*^9}, 3.617364303188251*^9, 
   3.617364464393681*^9, 3.6173645645096197`*^9, 3.617364703826067*^9, {
   3.617365158601513*^9, 3.617365160424486*^9}, 3.617365251174004*^9, 
   3.617365384501066*^9, {3.6174227828263474`*^9, 3.617422793640439*^9}, 
   3.6175237016436777`*^9, 3.617523921234788*^9, 3.617523955232328*^9, 
   3.617523989196043*^9, 3.617524095608919*^9, 3.617524134980177*^9, 
   3.6175241864798183`*^9, 3.617524248254257*^9, 3.617524287409411*^9, 
   3.617535101005168*^9, 3.617537560388986*^9, 3.617538142898405*^9, 
   3.617538252031724*^9, 3.617538595566818*^9, 3.6175391134115067`*^9, 
   3.61753917069139*^9, 3.617539285987173*^9, 3.617539325425516*^9, 
   3.6175393577980747`*^9, {3.6175395930062304`*^9, 3.617539621519095*^9}, 
   3.6175399764047327`*^9, 3.617540365238168*^9, 3.617540405661787*^9, 
   3.617540733108871*^9, 3.6175450383558397`*^9, 3.6175450786608343`*^9, 
   3.617545351423793*^9, 3.617545592184023*^9, 3.617545748335219*^9, {
   3.617545857118413*^9, 3.617545896876741*^9}, 3.617548525073999*^9, 
   3.617594240962425*^9, 3.617597720106283*^9, 3.6175977505669813`*^9, {
   3.6176066351359997`*^9, 3.6176066437486057`*^9}, 3.617606733686648*^9, 
   3.617609243699512*^9, 3.617609275158889*^9, {3.6185845989219637`*^9, 
   3.618584606538053*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xPerm`  version \"\>", 
   "\[InvisibleSpace]", "\<\"1.2.0\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2013", ",", "1", ",", "27"}], "}"}]}],
  SequenceForm["Package xAct`xPerm`  version ", "1.2.0", ", ", {2013, 1, 27}],
  
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6167538400554867`*^9, {3.616840834723184*^9, 3.616840861114718*^9}, 
   3.616840907025504*^9, 3.6168409605595093`*^9, 3.617185707035488*^9, {
   3.617364214833828*^9, 3.617364267253875*^9}, 3.617364303188251*^9, 
   3.617364464393681*^9, 3.6173645645096197`*^9, 3.617364703826067*^9, {
   3.617365158601513*^9, 3.617365160424486*^9}, 3.617365251174004*^9, 
   3.617365384501066*^9, {3.6174227828263474`*^9, 3.617422793640439*^9}, 
   3.6175237016436777`*^9, 3.617523921234788*^9, 3.617523955232328*^9, 
   3.617523989196043*^9, 3.617524095608919*^9, 3.617524134980177*^9, 
   3.6175241864798183`*^9, 3.617524248254257*^9, 3.617524287409411*^9, 
   3.617535101005168*^9, 3.617537560388986*^9, 3.617538142898405*^9, 
   3.617538252031724*^9, 3.617538595566818*^9, 3.6175391134115067`*^9, 
   3.61753917069139*^9, 3.617539285987173*^9, 3.617539325425516*^9, 
   3.6175393577980747`*^9, {3.6175395930062304`*^9, 3.617539621519095*^9}, 
   3.6175399764047327`*^9, 3.617540365238168*^9, 3.617540405661787*^9, 
   3.617540733108871*^9, 3.6175450383558397`*^9, 3.6175450786608343`*^9, 
   3.617545351423793*^9, 3.617545592184023*^9, 3.617545748335219*^9, {
   3.617545857118413*^9, 3.617545896876741*^9}, 3.617548525073999*^9, 
   3.617594240962425*^9, 3.617597720106283*^9, 3.6175977505669813`*^9, {
   3.6176066351359997`*^9, 3.6176066437486057`*^9}, 3.617606733686648*^9, 
   3.617609243699512*^9, 3.617609275158889*^9, {3.6185845989219637`*^9, 
   3.61858460654009*^9}}],

Cell[BoxData["\<\"CopyRight (C) 2003-2013, Jose M. Martin-Garcia, under the \
General Public License.\"\>"], "Print",
 CellChangeTimes->{
  3.6167538400554867`*^9, {3.616840834723184*^9, 3.616840861114718*^9}, 
   3.616840907025504*^9, 3.6168409605595093`*^9, 3.617185707035488*^9, {
   3.617364214833828*^9, 3.617364267253875*^9}, 3.617364303188251*^9, 
   3.617364464393681*^9, 3.6173645645096197`*^9, 3.617364703826067*^9, {
   3.617365158601513*^9, 3.617365160424486*^9}, 3.617365251174004*^9, 
   3.617365384501066*^9, {3.6174227828263474`*^9, 3.617422793640439*^9}, 
   3.6175237016436777`*^9, 3.617523921234788*^9, 3.617523955232328*^9, 
   3.617523989196043*^9, 3.617524095608919*^9, 3.617524134980177*^9, 
   3.6175241864798183`*^9, 3.617524248254257*^9, 3.617524287409411*^9, 
   3.617535101005168*^9, 3.617537560388986*^9, 3.617538142898405*^9, 
   3.617538252031724*^9, 3.617538595566818*^9, 3.6175391134115067`*^9, 
   3.61753917069139*^9, 3.617539285987173*^9, 3.617539325425516*^9, 
   3.6175393577980747`*^9, {3.6175395930062304`*^9, 3.617539621519095*^9}, 
   3.6175399764047327`*^9, 3.617540365238168*^9, 3.617540405661787*^9, 
   3.617540733108871*^9, 3.6175450383558397`*^9, 3.6175450786608343`*^9, 
   3.617545351423793*^9, 3.617545592184023*^9, 3.617545748335219*^9, {
   3.617545857118413*^9, 3.617545896876741*^9}, 3.617548525073999*^9, 
   3.617594240962425*^9, 3.617597720106283*^9, 3.6175977505669813`*^9, {
   3.6176066351359997`*^9, 3.6176066437486057`*^9}, 3.617606733686648*^9, 
   3.617609243699512*^9, 3.617609275158889*^9, {3.6185845989219637`*^9, 
   3.618584606541823*^9}}],

Cell[BoxData["\<\"Connecting to external mac executable...\"\>"], "Print",
 CellChangeTimes->{
  3.6167538400554867`*^9, {3.616840834723184*^9, 3.616840861114718*^9}, 
   3.616840907025504*^9, 3.6168409605595093`*^9, 3.617185707035488*^9, {
   3.617364214833828*^9, 3.617364267253875*^9}, 3.617364303188251*^9, 
   3.617364464393681*^9, 3.6173645645096197`*^9, 3.617364703826067*^9, {
   3.617365158601513*^9, 3.617365160424486*^9}, 3.617365251174004*^9, 
   3.617365384501066*^9, {3.6174227828263474`*^9, 3.617422793640439*^9}, 
   3.6175237016436777`*^9, 3.617523921234788*^9, 3.617523955232328*^9, 
   3.617523989196043*^9, 3.617524095608919*^9, 3.617524134980177*^9, 
   3.6175241864798183`*^9, 3.617524248254257*^9, 3.617524287409411*^9, 
   3.617535101005168*^9, 3.617537560388986*^9, 3.617538142898405*^9, 
   3.617538252031724*^9, 3.617538595566818*^9, 3.6175391134115067`*^9, 
   3.61753917069139*^9, 3.617539285987173*^9, 3.617539325425516*^9, 
   3.6175393577980747`*^9, {3.6175395930062304`*^9, 3.617539621519095*^9}, 
   3.6175399764047327`*^9, 3.617540365238168*^9, 3.617540405661787*^9, 
   3.617540733108871*^9, 3.6175450383558397`*^9, 3.6175450786608343`*^9, 
   3.617545351423793*^9, 3.617545592184023*^9, 3.617545748335219*^9, {
   3.617545857118413*^9, 3.617545896876741*^9}, 3.617548525073999*^9, 
   3.617594240962425*^9, 3.617597720106283*^9, 3.6175977505669813`*^9, {
   3.6176066351359997`*^9, 3.6176066437486057`*^9}, 3.617606733686648*^9, 
   3.617609243699512*^9, 3.617609275158889*^9, {3.6185845989219637`*^9, 
   3.618584606571795*^9}}],

Cell[BoxData["\<\"Connection established.\"\>"], "Print",
 CellChangeTimes->{
  3.6167538400554867`*^9, {3.616840834723184*^9, 3.616840861114718*^9}, 
   3.616840907025504*^9, 3.6168409605595093`*^9, 3.617185707035488*^9, {
   3.617364214833828*^9, 3.617364267253875*^9}, 3.617364303188251*^9, 
   3.617364464393681*^9, 3.6173645645096197`*^9, 3.617364703826067*^9, {
   3.617365158601513*^9, 3.617365160424486*^9}, 3.617365251174004*^9, 
   3.617365384501066*^9, {3.6174227828263474`*^9, 3.617422793640439*^9}, 
   3.6175237016436777`*^9, 3.617523921234788*^9, 3.617523955232328*^9, 
   3.617523989196043*^9, 3.617524095608919*^9, 3.617524134980177*^9, 
   3.6175241864798183`*^9, 3.617524248254257*^9, 3.617524287409411*^9, 
   3.617535101005168*^9, 3.617537560388986*^9, 3.617538142898405*^9, 
   3.617538252031724*^9, 3.617538595566818*^9, 3.6175391134115067`*^9, 
   3.61753917069139*^9, 3.617539285987173*^9, 3.617539325425516*^9, 
   3.6175393577980747`*^9, {3.6175395930062304`*^9, 3.617539621519095*^9}, 
   3.6175399764047327`*^9, 3.617540365238168*^9, 3.617540405661787*^9, 
   3.617540733108871*^9, 3.6175450383558397`*^9, 3.6175450786608343`*^9, 
   3.617545351423793*^9, 3.617545592184023*^9, 3.617545748335219*^9, {
   3.617545857118413*^9, 3.617545896876741*^9}, 3.617548525073999*^9, 
   3.617594240962425*^9, 3.617597720106283*^9, 3.6175977505669813`*^9, {
   3.6176066351359997`*^9, 3.6176066437486057`*^9}, 3.617606733686648*^9, 
   3.617609243699512*^9, 3.617609275158889*^9, {3.6185845989219637`*^9, 
   3.6185846066049967`*^9}}],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.6167538400554867`*^9, {3.616840834723184*^9, 3.616840861114718*^9}, 
   3.616840907025504*^9, 3.6168409605595093`*^9, 3.617185707035488*^9, {
   3.617364214833828*^9, 3.617364267253875*^9}, 3.617364303188251*^9, 
   3.617364464393681*^9, 3.6173645645096197`*^9, 3.617364703826067*^9, {
   3.617365158601513*^9, 3.617365160424486*^9}, 3.617365251174004*^9, 
   3.617365384501066*^9, {3.6174227828263474`*^9, 3.617422793640439*^9}, 
   3.6175237016436777`*^9, 3.617523921234788*^9, 3.617523955232328*^9, 
   3.617523989196043*^9, 3.617524095608919*^9, 3.617524134980177*^9, 
   3.6175241864798183`*^9, 3.617524248254257*^9, 3.617524287409411*^9, 
   3.617535101005168*^9, 3.617537560388986*^9, 3.617538142898405*^9, 
   3.617538252031724*^9, 3.617538595566818*^9, 3.6175391134115067`*^9, 
   3.61753917069139*^9, 3.617539285987173*^9, 3.617539325425516*^9, 
   3.6175393577980747`*^9, {3.6175395930062304`*^9, 3.617539621519095*^9}, 
   3.6175399764047327`*^9, 3.617540365238168*^9, 3.617540405661787*^9, 
   3.617540733108871*^9, 3.6175450383558397`*^9, 3.6175450786608343`*^9, 
   3.617545351423793*^9, 3.617545592184023*^9, 3.617545748335219*^9, {
   3.617545857118413*^9, 3.617545896876741*^9}, 3.617548525073999*^9, 
   3.617594240962425*^9, 3.617597720106283*^9, 3.6175977505669813`*^9, {
   3.6176066351359997`*^9, 3.6176066437486057`*^9}, 3.617606733686648*^9, 
   3.617609243699512*^9, 3.617609275158889*^9, {3.6185845989219637`*^9, 
   3.61858460663608*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xTensor`  version \"\>", 
   "\[InvisibleSpace]", "\<\"1.0.5\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2013", ",", "1", ",", "30"}], "}"}]}],
  SequenceForm[
  "Package xAct`xTensor`  version ", "1.0.5", ", ", {2013, 1, 30}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6167538400554867`*^9, {3.616840834723184*^9, 3.616840861114718*^9}, 
   3.616840907025504*^9, 3.6168409605595093`*^9, 3.617185707035488*^9, {
   3.617364214833828*^9, 3.617364267253875*^9}, 3.617364303188251*^9, 
   3.617364464393681*^9, 3.6173645645096197`*^9, 3.617364703826067*^9, {
   3.617365158601513*^9, 3.617365160424486*^9}, 3.617365251174004*^9, 
   3.617365384501066*^9, {3.6174227828263474`*^9, 3.617422793640439*^9}, 
   3.6175237016436777`*^9, 3.617523921234788*^9, 3.617523955232328*^9, 
   3.617523989196043*^9, 3.617524095608919*^9, 3.617524134980177*^9, 
   3.6175241864798183`*^9, 3.617524248254257*^9, 3.617524287409411*^9, 
   3.617535101005168*^9, 3.617537560388986*^9, 3.617538142898405*^9, 
   3.617538252031724*^9, 3.617538595566818*^9, 3.6175391134115067`*^9, 
   3.61753917069139*^9, 3.617539285987173*^9, 3.617539325425516*^9, 
   3.6175393577980747`*^9, {3.6175395930062304`*^9, 3.617539621519095*^9}, 
   3.6175399764047327`*^9, 3.617540365238168*^9, 3.617540405661787*^9, 
   3.617540733108871*^9, 3.6175450383558397`*^9, 3.6175450786608343`*^9, 
   3.617545351423793*^9, 3.617545592184023*^9, 3.617545748335219*^9, {
   3.617545857118413*^9, 3.617545896876741*^9}, 3.617548525073999*^9, 
   3.617594240962425*^9, 3.617597720106283*^9, 3.6175977505669813`*^9, {
   3.6176066351359997`*^9, 3.6176066437486057`*^9}, 3.617606733686648*^9, 
   3.617609243699512*^9, 3.617609275158889*^9, {3.6185845989219637`*^9, 
   3.618584606637967*^9}}],

Cell[BoxData["\<\"CopyRight (C) 2002-2013, Jose M. Martin-Garcia, under the \
General Public License.\"\>"], "Print",
 CellChangeTimes->{
  3.6167538400554867`*^9, {3.616840834723184*^9, 3.616840861114718*^9}, 
   3.616840907025504*^9, 3.6168409605595093`*^9, 3.617185707035488*^9, {
   3.617364214833828*^9, 3.617364267253875*^9}, 3.617364303188251*^9, 
   3.617364464393681*^9, 3.6173645645096197`*^9, 3.617364703826067*^9, {
   3.617365158601513*^9, 3.617365160424486*^9}, 3.617365251174004*^9, 
   3.617365384501066*^9, {3.6174227828263474`*^9, 3.617422793640439*^9}, 
   3.6175237016436777`*^9, 3.617523921234788*^9, 3.617523955232328*^9, 
   3.617523989196043*^9, 3.617524095608919*^9, 3.617524134980177*^9, 
   3.6175241864798183`*^9, 3.617524248254257*^9, 3.617524287409411*^9, 
   3.617535101005168*^9, 3.617537560388986*^9, 3.617538142898405*^9, 
   3.617538252031724*^9, 3.617538595566818*^9, 3.6175391134115067`*^9, 
   3.61753917069139*^9, 3.617539285987173*^9, 3.617539325425516*^9, 
   3.6175393577980747`*^9, {3.6175395930062304`*^9, 3.617539621519095*^9}, 
   3.6175399764047327`*^9, 3.617540365238168*^9, 3.617540405661787*^9, 
   3.617540733108871*^9, 3.6175450383558397`*^9, 3.6175450786608343`*^9, 
   3.617545351423793*^9, 3.617545592184023*^9, 3.617545748335219*^9, {
   3.617545857118413*^9, 3.617545896876741*^9}, 3.617548525073999*^9, 
   3.617594240962425*^9, 3.617597720106283*^9, 3.6175977505669813`*^9, {
   3.6176066351359997`*^9, 3.6176066437486057`*^9}, 3.617606733686648*^9, 
   3.617609243699512*^9, 3.617609275158889*^9, {3.6185845989219637`*^9, 
   3.61858460663973*^9}}],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.6167538400554867`*^9, {3.616840834723184*^9, 3.616840861114718*^9}, 
   3.616840907025504*^9, 3.6168409605595093`*^9, 3.617185707035488*^9, {
   3.617364214833828*^9, 3.617364267253875*^9}, 3.617364303188251*^9, 
   3.617364464393681*^9, 3.6173645645096197`*^9, 3.617364703826067*^9, {
   3.617365158601513*^9, 3.617365160424486*^9}, 3.617365251174004*^9, 
   3.617365384501066*^9, {3.6174227828263474`*^9, 3.617422793640439*^9}, 
   3.6175237016436777`*^9, 3.617523921234788*^9, 3.617523955232328*^9, 
   3.617523989196043*^9, 3.617524095608919*^9, 3.617524134980177*^9, 
   3.6175241864798183`*^9, 3.617524248254257*^9, 3.617524287409411*^9, 
   3.617535101005168*^9, 3.617537560388986*^9, 3.617538142898405*^9, 
   3.617538252031724*^9, 3.617538595566818*^9, 3.6175391134115067`*^9, 
   3.61753917069139*^9, 3.617539285987173*^9, 3.617539325425516*^9, 
   3.6175393577980747`*^9, {3.6175395930062304`*^9, 3.617539621519095*^9}, 
   3.6175399764047327`*^9, 3.617540365238168*^9, 3.617540405661787*^9, 
   3.617540733108871*^9, 3.6175450383558397`*^9, 3.6175450786608343`*^9, 
   3.617545351423793*^9, 3.617545592184023*^9, 3.617545748335219*^9, {
   3.617545857118413*^9, 3.617545896876741*^9}, 3.617548525073999*^9, 
   3.617594240962425*^9, 3.617597720106283*^9, 3.6175977505669813`*^9, {
   3.6176066351359997`*^9, 3.6176066437486057`*^9}, 3.617606733686648*^9, 
   3.617609243699512*^9, 3.617609275158889*^9, {3.6185845989219637`*^9, 
   3.618584606732348*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`ByParts version \"\>", 
   "\[InvisibleSpace]", "\<\"1.0.1\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2014", ",", "9", ",", "1"}], "}"}]}],
  SequenceForm["Package xAct`ByParts version ", "1.0.1", ", ", {2014, 9, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6167538400554867`*^9, {3.616840834723184*^9, 3.616840861114718*^9}, 
   3.616840907025504*^9, 3.6168409605595093`*^9, 3.617185707035488*^9, {
   3.617364214833828*^9, 3.617364267253875*^9}, 3.617364303188251*^9, 
   3.617364464393681*^9, 3.6173645645096197`*^9, 3.617364703826067*^9, {
   3.617365158601513*^9, 3.617365160424486*^9}, 3.617365251174004*^9, 
   3.617365384501066*^9, {3.6174227828263474`*^9, 3.617422793640439*^9}, 
   3.6175237016436777`*^9, 3.617523921234788*^9, 3.617523955232328*^9, 
   3.617523989196043*^9, 3.617524095608919*^9, 3.617524134980177*^9, 
   3.6175241864798183`*^9, 3.617524248254257*^9, 3.617524287409411*^9, 
   3.617535101005168*^9, 3.617537560388986*^9, 3.617538142898405*^9, 
   3.617538252031724*^9, 3.617538595566818*^9, 3.6175391134115067`*^9, 
   3.61753917069139*^9, 3.617539285987173*^9, 3.617539325425516*^9, 
   3.6175393577980747`*^9, {3.6175395930062304`*^9, 3.617539621519095*^9}, 
   3.6175399764047327`*^9, 3.617540365238168*^9, 3.617540405661787*^9, 
   3.617540733108871*^9, 3.6175450383558397`*^9, 3.6175450786608343`*^9, 
   3.617545351423793*^9, 3.617545592184023*^9, 3.617545748335219*^9, {
   3.617545857118413*^9, 3.617545896876741*^9}, 3.617548525073999*^9, 
   3.617594240962425*^9, 3.617597720106283*^9, 3.6175977505669813`*^9, {
   3.6176066351359997`*^9, 3.6176066437486057`*^9}, 3.617606733686648*^9, 
   3.617609243699512*^9, 3.617609275158889*^9, {3.6185845989219637`*^9, 
   3.6185846067344303`*^9}}],

Cell[BoxData["\<\"Copyright (C) 2013-2014, University of Sussex, under the \
General Public License.\"\>"], "Print",
 CellChangeTimes->{
  3.6167538400554867`*^9, {3.616840834723184*^9, 3.616840861114718*^9}, 
   3.616840907025504*^9, 3.6168409605595093`*^9, 3.617185707035488*^9, {
   3.617364214833828*^9, 3.617364267253875*^9}, 3.617364303188251*^9, 
   3.617364464393681*^9, 3.6173645645096197`*^9, 3.617364703826067*^9, {
   3.617365158601513*^9, 3.617365160424486*^9}, 3.617365251174004*^9, 
   3.617365384501066*^9, {3.6174227828263474`*^9, 3.617422793640439*^9}, 
   3.6175237016436777`*^9, 3.617523921234788*^9, 3.617523955232328*^9, 
   3.617523989196043*^9, 3.617524095608919*^9, 3.617524134980177*^9, 
   3.6175241864798183`*^9, 3.617524248254257*^9, 3.617524287409411*^9, 
   3.617535101005168*^9, 3.617537560388986*^9, 3.617538142898405*^9, 
   3.617538252031724*^9, 3.617538595566818*^9, 3.6175391134115067`*^9, 
   3.61753917069139*^9, 3.617539285987173*^9, 3.617539325425516*^9, 
   3.6175393577980747`*^9, {3.6175395930062304`*^9, 3.617539621519095*^9}, 
   3.6175399764047327`*^9, 3.617540365238168*^9, 3.617540405661787*^9, 
   3.617540733108871*^9, 3.6175450383558397`*^9, 3.6175450786608343`*^9, 
   3.617545351423793*^9, 3.617545592184023*^9, 3.617545748335219*^9, {
   3.617545857118413*^9, 3.617545896876741*^9}, 3.617548525073999*^9, 
   3.617594240962425*^9, 3.617597720106283*^9, 3.6175977505669813`*^9, {
   3.6176066351359997`*^9, 3.6176066437486057`*^9}, 3.617606733686648*^9, 
   3.617609243699512*^9, 3.617609275158889*^9, {3.6185845989219637`*^9, 
   3.618584606737108*^9}}],

Cell[BoxData["\<\"Written by Joseph Elliston.\"\>"], "Print",
 CellChangeTimes->{
  3.6167538400554867`*^9, {3.616840834723184*^9, 3.616840861114718*^9}, 
   3.616840907025504*^9, 3.6168409605595093`*^9, 3.617185707035488*^9, {
   3.617364214833828*^9, 3.617364267253875*^9}, 3.617364303188251*^9, 
   3.617364464393681*^9, 3.6173645645096197`*^9, 3.617364703826067*^9, {
   3.617365158601513*^9, 3.617365160424486*^9}, 3.617365251174004*^9, 
   3.617365384501066*^9, {3.6174227828263474`*^9, 3.617422793640439*^9}, 
   3.6175237016436777`*^9, 3.617523921234788*^9, 3.617523955232328*^9, 
   3.617523989196043*^9, 3.617524095608919*^9, 3.617524134980177*^9, 
   3.6175241864798183`*^9, 3.617524248254257*^9, 3.617524287409411*^9, 
   3.617535101005168*^9, 3.617537560388986*^9, 3.617538142898405*^9, 
   3.617538252031724*^9, 3.617538595566818*^9, 3.6175391134115067`*^9, 
   3.61753917069139*^9, 3.617539285987173*^9, 3.617539325425516*^9, 
   3.6175393577980747`*^9, {3.6175395930062304`*^9, 3.617539621519095*^9}, 
   3.6175399764047327`*^9, 3.617540365238168*^9, 3.617540405661787*^9, 
   3.617540733108871*^9, 3.6175450383558397`*^9, 3.6175450786608343`*^9, 
   3.617545351423793*^9, 3.617545592184023*^9, 3.617545748335219*^9, {
   3.617545857118413*^9, 3.617545896876741*^9}, 3.617548525073999*^9, 
   3.617594240962425*^9, 3.617597720106283*^9, 3.6175977505669813`*^9, {
   3.6176066351359997`*^9, 3.6176066437486057`*^9}, 3.617606733686648*^9, 
   3.617609243699512*^9, 3.617609275158889*^9, {3.6185845989219637`*^9, 
   3.6185846067395372`*^9}}],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.6167538400554867`*^9, {3.616840834723184*^9, 3.616840861114718*^9}, 
   3.616840907025504*^9, 3.6168409605595093`*^9, 3.617185707035488*^9, {
   3.617364214833828*^9, 3.617364267253875*^9}, 3.617364303188251*^9, 
   3.617364464393681*^9, 3.6173645645096197`*^9, 3.617364703826067*^9, {
   3.617365158601513*^9, 3.617365160424486*^9}, 3.617365251174004*^9, 
   3.617365384501066*^9, {3.6174227828263474`*^9, 3.617422793640439*^9}, 
   3.6175237016436777`*^9, 3.617523921234788*^9, 3.617523955232328*^9, 
   3.617523989196043*^9, 3.617524095608919*^9, 3.617524134980177*^9, 
   3.6175241864798183`*^9, 3.617524248254257*^9, 3.617524287409411*^9, 
   3.617535101005168*^9, 3.617537560388986*^9, 3.617538142898405*^9, 
   3.617538252031724*^9, 3.617538595566818*^9, 3.6175391134115067`*^9, 
   3.61753917069139*^9, 3.617539285987173*^9, 3.617539325425516*^9, 
   3.6175393577980747`*^9, {3.6175395930062304`*^9, 3.617539621519095*^9}, 
   3.6175399764047327`*^9, 3.617540365238168*^9, 3.617540405661787*^9, 
   3.617540733108871*^9, 3.6175450383558397`*^9, 3.6175450786608343`*^9, 
   3.617545351423793*^9, 3.617545592184023*^9, 3.617545748335219*^9, {
   3.617545857118413*^9, 3.617545896876741*^9}, 3.617548525073999*^9, 
   3.617594240962425*^9, 3.617597720106283*^9, 3.6175977505669813`*^9, {
   3.6176066351359997`*^9, 3.6176066437486057`*^9}, 3.617606733686648*^9, 
   3.617609243699512*^9, 3.617609275158889*^9, {3.6185845989219637`*^9, 
   3.618584606741931*^9}}],

Cell[BoxData["\<\"These packages come with ABSOLUTELY NO WARRANTY; for \
details type Disclaimer[]. This is free software, and you are welcome to \
redistribute it under certain conditions. See the General Public License for \
details.\"\>"], "Print",
 CellChangeTimes->{
  3.6167538400554867`*^9, {3.616840834723184*^9, 3.616840861114718*^9}, 
   3.616840907025504*^9, 3.6168409605595093`*^9, 3.617185707035488*^9, {
   3.617364214833828*^9, 3.617364267253875*^9}, 3.617364303188251*^9, 
   3.617364464393681*^9, 3.6173645645096197`*^9, 3.617364703826067*^9, {
   3.617365158601513*^9, 3.617365160424486*^9}, 3.617365251174004*^9, 
   3.617365384501066*^9, {3.6174227828263474`*^9, 3.617422793640439*^9}, 
   3.6175237016436777`*^9, 3.617523921234788*^9, 3.617523955232328*^9, 
   3.617523989196043*^9, 3.617524095608919*^9, 3.617524134980177*^9, 
   3.6175241864798183`*^9, 3.617524248254257*^9, 3.617524287409411*^9, 
   3.617535101005168*^9, 3.617537560388986*^9, 3.617538142898405*^9, 
   3.617538252031724*^9, 3.617538595566818*^9, 3.6175391134115067`*^9, 
   3.61753917069139*^9, 3.617539285987173*^9, 3.617539325425516*^9, 
   3.6175393577980747`*^9, {3.6175395930062304`*^9, 3.617539621519095*^9}, 
   3.6175399764047327`*^9, 3.617540365238168*^9, 3.617540405661787*^9, 
   3.617540733108871*^9, 3.6175450383558397`*^9, 3.6175450786608343`*^9, 
   3.617545351423793*^9, 3.617545592184023*^9, 3.617545748335219*^9, {
   3.617545857118413*^9, 3.617545896876741*^9}, 3.617548525073999*^9, 
   3.617594240962425*^9, 3.617597720106283*^9, 3.6175977505669813`*^9, {
   3.6176066351359997`*^9, 3.6176066437486057`*^9}, 3.617606733686648*^9, 
   3.617609243699512*^9, 3.617609275158889*^9, {3.6185845989219637`*^9, 
   3.618584606744124*^9}}],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.6167538400554867`*^9, {3.616840834723184*^9, 3.616840861114718*^9}, 
   3.616840907025504*^9, 3.6168409605595093`*^9, 3.617185707035488*^9, {
   3.617364214833828*^9, 3.617364267253875*^9}, 3.617364303188251*^9, 
   3.617364464393681*^9, 3.6173645645096197`*^9, 3.617364703826067*^9, {
   3.617365158601513*^9, 3.617365160424486*^9}, 3.617365251174004*^9, 
   3.617365384501066*^9, {3.6174227828263474`*^9, 3.617422793640439*^9}, 
   3.6175237016436777`*^9, 3.617523921234788*^9, 3.617523955232328*^9, 
   3.617523989196043*^9, 3.617524095608919*^9, 3.617524134980177*^9, 
   3.6175241864798183`*^9, 3.617524248254257*^9, 3.617524287409411*^9, 
   3.617535101005168*^9, 3.617537560388986*^9, 3.617538142898405*^9, 
   3.617538252031724*^9, 3.617538595566818*^9, 3.6175391134115067`*^9, 
   3.61753917069139*^9, 3.617539285987173*^9, 3.617539325425516*^9, 
   3.6175393577980747`*^9, {3.6175395930062304`*^9, 3.617539621519095*^9}, 
   3.6175399764047327`*^9, 3.617540365238168*^9, 3.617540405661787*^9, 
   3.617540733108871*^9, 3.6175450383558397`*^9, 3.6175450786608343`*^9, 
   3.617545351423793*^9, 3.617545592184023*^9, 3.617545748335219*^9, {
   3.617545857118413*^9, 3.617545896876741*^9}, 3.617548525073999*^9, 
   3.617594240962425*^9, 3.617597720106283*^9, 3.6175977505669813`*^9, {
   3.6176066351359997`*^9, 3.6176066437486057`*^9}, 3.617606733686648*^9, 
   3.617609243699512*^9, 3.617609275158889*^9, {3.6185845989219637`*^9, 
   3.6185846067461147`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Detailed Description of the ByParts package\
\>", "Subsection",
 CellChangeTimes->{{3.6140661182525873`*^9, 3.614066128781103*^9}, {
  3.6167538570889378`*^9, 3.616753858086111*^9}}],

Cell[CellGroupData[{

Cell[BoxData["$ByPartsDescription"], "Input",
 CellChangeTimes->{{3.6167538617833557`*^9, 3.616753864202365*^9}}],

Cell[BoxData["\<\"The motivation for creating this package is that performing \
intergations by parts on large expressions can be tedious and error-prone. By \
automating this calculation we can also simplify the output from integration \
by parts and make all possible cancellations between terms without having to \
rely on being able to do this by eye. Furthermore, one can employ the \
ToCanonical function in xTensor to ensure that all terms are in a canonical \
form and therefore maximise these simplifications. \\n\\nThroughout we ignore \
total derivative terms under the implicit assumption that these are \
negligible on the boundary of the integration. This is not always the case \
for integations with a boundary and in such scenarios the user must take \
responsibility for ensuring that their variational problem is well posed and \
they must keep track of boundary terms where relevant. Nevertheless, most \
standard calculations to derive the local equations of motion are not plagued \
by such issues and in these cases one can apply this package without concern \
about boundary contributions.\\n\\nFor an arbitrary expression, there is no \
clear algorithmic procedure for making the integrations by parts because the \
desired goal is a function of user-preference. As a result, this package \
leaves the user in control of which integrations by parts are computed, and \
simply provides a nice interface for performing the calculation. \\n\\nThis \
package is able to carry out integrations by parts on any term of the form: \
rest*Der1@Der2@...DerN@arg where Der1, Der2,... etc are either ParamD[indice] \
or derivatives der[indice] with CovDQ@der=True. These derivatives can \
therefore include any user-defined derivatives as well as the fiducial\.1d PD \
derivative. 'arg' is some general argument and 'rest' is some general \
multiplicative factor. \\n\\nWe assume that each type of derivative 'DerX' \
commutes with any other derivative 'DerY' except when both are the same \
covariant derivative with different indices. This assumption requires that \
any covariant derivatives that will be commuted are defined on independent \
spaces. If this proves to be a restriction for a given calculation, then one \
can always expand out one or both of the covariant derivatives into partial \
derivatives.\\n\\nIf one wants to integate by parts with a derivative that is \
not ParamD or PD then it is first necessary to commute the derivative to the \
outside of any other derivatives of the same type. This commutation will \
yield new curvature terms. Alternatively, if one is integrating by parts with \
partial derivatives then it is necessary to first lower any contravariant \
indices using the SeparateMetric[] command.\\n\\nThe key function is the \
'ByParts' function. This function contains the list of integrations that one \
needs to compute and these are executed sequentially. To specify a given \
integration by parts, one needs to provide the term to be integrated, the \
piece of that term containing the derivative to be moved and then the index \
of the derivative. This is explained in greater detail in the examples below. \
This method has been developed so that the user can copy and paste the \
expressions to perform the integrations speedily. \\n\\n'ByParts' is likely \
to be the only function that the user will use. However, it is certainly \
conceviable that the user may want to perform some user-defined \
simplification rules after each integration by parts. For this reason we \
provide the function 'AfterByParts' which, by default, does nothing. The user \
can modify this function to do whatever they like, such as setting \
derivatives of a particular term to zero.\\n\\nThe code that makes up the \
'ByParts' function calls another function 'ByPartsKernel' to perform the \
integration by parts itself. The key role of 'ByPartsKernel' is to compare \
the output of the integration by parts to the input. If one of the outputs is \
equal to a negative integer times the input then this means that there is a \
symmetry in the expression and the output is modified accordingly. One can \
therefore view the 'ByParts' function as the code that takes a general sum of \
terms and a list of integrations and feeds these into the 'ByPartsKernel' \
function as appropriate, before collecting and simplifying the output.\"\>"], \
"Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAGIeTynJzE+vHL8lO2tP/vzKMcRzox2ILjuR4A2i1yWW
x4DoGq/7C0D0hNKSjSB6+keVXeuB9I/Dm/4/ANIeZ0ykHgLp2M0P5EB0h66u
Moi2CgsxANHJf1+ZgOgdZ2ZYg2hONRFnED0p7Kc7iPZ7dHnCMyC9yV388HMg
vcGqkOcFkP5v3yMJoiXDal1AdPtdx1YQrVCY2AOi2R+cmgWi/Z7smA+iv645
shhEe8joHgTRciH6R0H02VNSH0F02N9Nii+BdF/7ATUQfSt9nT+Iftytl/8a
SIs8LJwIotcffHoIRD/Ni74IoudbF14F0Xteeci9BdJrEoVOcX155QgA1IDF
wA==
  "]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Basic examples using covariant derivatives\
\>", "Section",
 CellChangeTimes->{{3.617545966164856*^9, 3.617545986663301*^9}, 
   3.61759408035071*^9, {3.61759593806883*^9, 3.617595941067375*^9}}],

Cell["\<\
Perhaps unexpectedly, integration by parts using covariant derivatives is \
easier than using partial derivatives because the contravariant/covariant \
nature of indices is irrelevant. This is because index raising and lowering \
is achieved via metric factors and these commute with the derivatives. \
\>", "Text",
 CellChangeTimes->{{3.6175940980780067`*^9, 3.61759419032442*^9}}],

Cell[CellGroupData[{

Cell["Define quantities", "Subsection",
 CellChangeTimes->{{3.616840789388999*^9, 3.6168407902743807`*^9}, {
  3.617545113279117*^9, 3.6175451327242527`*^9}, {3.617545930559195*^9, 
  3.6175459552588873`*^9}, {3.617545992653026*^9, 3.617545995667635*^9}}],

Cell["\<\
We need to define a manifold (formally we make this dimension 3 but this is \
arbitrary) such that we can define some indices which we take as the \
lowercase Roman letters between i and z. To define a scalar quantity we need \
to define a metric, which we call h, and we also define CD3 as the covariant \
derivative associated with h. Finally we define a scalar \[CurlyPhi].\
\>", "Text",
 CellChangeTimes->{{3.617546125839961*^9, 3.617546221035921*^9}, {
  3.617594209079093*^9, 3.617594226361561*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefManifold", "[", 
   RowBox[{"M3", ",", "3", ",", 
    RowBox[{"IndexRange", "[", 
     RowBox[{"i", ",", "z"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DefMetric", "[", 
  RowBox[{"1", ",", 
   RowBox[{"h", "[", 
    RowBox[{
     RowBox[{"-", "i"}], ",", 
     RowBox[{"-", "j"}]}], "]"}], ",", "CD3", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<;\>\"", ",", "\"\<\[Del]\>\""}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"\[CurlyPhi]", "[", "]"}], ",", "M3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.617545247615431*^9, 3.6175452698044567`*^9}, {
  3.617545364214363*^9, 3.617545364485751*^9}, {3.6175455174865007`*^9, 
  3.6175455752150097`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Example 1 - basic syntax", "Subsection"]], \
"Subsection",
 CellChangeTimes->{{3.617546014190298*^9, 3.617546015832621*^9}, {
  3.6175469728710413`*^9, 3.617546978621099*^9}}],

Cell["\<\
As a simple example, we take an expression with two free indices:\
\>", "Text",
 CellChangeTimes->{{3.617546335724234*^9, 3.6175463816223803`*^9}, {
  3.617596161062458*^9, 3.6175961811943903`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"\[CurlyPhi]", "[", "]"}], 
   RowBox[{
    RowBox[{"CD3", "[", 
     RowBox[{"-", "i"}], "]"}], "@", 
    RowBox[{
     RowBox[{"CD3", "[", "j", "]"}], "@", 
     RowBox[{"\[CurlyPhi]", "[", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.617545317995997*^9, 3.6175453207495127`*^9}, {
  3.6175453819376373`*^9, 3.617545448440494*^9}, {3.6175485859754057`*^9, 
  3.6175486053235617`*^9}, {3.6175942612820673`*^9, 3.6175942731473618`*^9}, {
  3.617596184052032*^9, 3.61759619154206*^9}}],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox["\[CurlyPhi]",
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`\[CurlyPhi][],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    RowBox[{
     SubscriptBox["\[Del]", "i"], 
     SuperscriptBox["\[Del]", "j"], "\[CurlyPhi]"}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`CD3[-$CellContext`i][
    $CellContext`CD3[$CellContext`j][
     $CellContext`\[CurlyPhi][]]],
   Editable->False]}]], "Output",
 CellChangeTimes->{
  3.6175453214175034`*^9, {3.617545375687696*^9, 3.6175454000433607`*^9}, 
   3.617545438031508*^9, 3.617545600423053*^9, 3.617545751485708*^9, 
   3.617545867181991*^9, 3.617545899848105*^9, 3.617548533447926*^9, {
   3.617548597577012*^9, 3.617548605584968*^9}, {3.617594267152269*^9, 
   3.617594273747199*^9}, 3.617596192613141*^9, 3.617609309994153*^9, 
   3.618584626423909*^9}]
}, Open  ]],

Cell["We then integrate by parts using the ByParts function. ", "Text",
 CellChangeTimes->{{3.617546383974341*^9, 3.617546588773691*^9}, {
  3.6175962046143827`*^9, 3.617596205230492*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ByParts", "[", 
  RowBox[{"expr", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        StyleBox["\[CurlyPhi]",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`\[CurlyPhi][],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[Del]", "i"], 
          SuperscriptBox["\[Del]", "j"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[-$CellContext`i][
         $CellContext`CD3[$CellContext`j][
          $CellContext`\[CurlyPhi][]]],
        Editable->False]}], ",", 
      InterpretationBox[
       StyleBox[
        RowBox[{
         SubscriptBox["\[Del]", "i"], 
         SuperscriptBox["\[Del]", "j"], "\[CurlyPhi]"}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`CD3[-$CellContext`i][
        $CellContext`CD3[$CellContext`j][
         $CellContext`\[CurlyPhi][]]],
       Editable->False], ",", 
      RowBox[{"-", "i"}]}], "}"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.616842940540906*^9, 3.616842968775675*^9}, {
   3.61684300941394*^9, 3.616843016507594*^9}, {3.6168439654821157`*^9, 
   3.616843999120797*^9}, {3.6174238389835443`*^9, 3.6174238414302473`*^9}, {
   3.6174254856285686`*^9, 3.6174255000755796`*^9}, {3.617425536076208*^9, 
   3.617425570817708*^9}, {3.6174352564772253`*^9, 3.617435258293249*^9}, {
   3.617535126234208*^9, 3.6175351628873987`*^9}, {3.617537576939424*^9, 
   3.617537581990041*^9}, {3.617538269099112*^9, 3.617538305467205*^9}, {
   3.617538612856738*^9, 3.617538644021284*^9}, {3.617539364017521*^9, 
   3.617539385429728*^9}, {3.617539630907613*^9, 3.617539665789651*^9}, {
   3.617539837122118*^9, 3.61753989283414*^9}, {3.617540002142088*^9, 
   3.617540053358449*^9}, {3.617540158205359*^9, 3.61754018013444*^9}, {
   3.617540788938238*^9, 3.6175408235650673`*^9}, {3.617540861383713*^9, 
   3.617540877450938*^9}, {3.617544546825556*^9, 3.617544549557807*^9}, {
   3.617544593486512*^9, 3.617544632623382*^9}, {3.617545415594693*^9, 
   3.61754549490304*^9}, 3.617548541832312*^9, {3.6175942891283503`*^9, 
   3.617594326783237*^9}, {3.617596199395069*^9, 3.617596239399659*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[-$CellContext`i][
     $CellContext`\[CurlyPhi][]],
    Editable->False]}], " ", 
  InterpretationBox[
   StyleBox[
    RowBox[{
     SuperscriptBox["\[Del]", "j"], "\[CurlyPhi]"}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`CD3[$CellContext`j][
    $CellContext`\[CurlyPhi][]],
   Editable->False]}]], "Output",
 CellChangeTimes->{3.617596240169475*^9, 3.6176093100277157`*^9, 
  3.618584626540145*^9}]
}, Open  ]],

Cell["\<\
The second argument of ByParts contains three parts which tell us, in order, \
which term to integrate, which piece of that term to remove a derivative from \
and which derivative to move. The reason for the double {{ }} notation will \
become clear later when we perform multiple intergations by parts \
sequentially.\
\>", "Text",
 CellChangeTimes->{3.617546595307581*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Example 2 - total derivatives", "Subsection"]], \
"Subsection",
 CellChangeTimes->{{3.617546014190298*^9, 3.617546015832621*^9}, {
  3.617546045844542*^9, 3.617546045911034*^9}, {3.617546967300789*^9, 
  3.6175469701479*^9}}],

Cell["\<\
A total derivative is zero under intergation by parts:\
\>", "Text",
 CellChangeTimes->{{3.6175466147785673`*^9, 3.617546632297948*^9}, 
   3.617546697788888*^9, {3.6175962687231283`*^9, 3.617596275957223*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"CD3", "[", 
    RowBox[{"-", "i"}], "]"}], "@", 
   RowBox[{
    RowBox[{"CD3", "[", "i", "]"}], "@", 
    RowBox[{"\[CurlyPhi]", "[", "]"}], " "}]}]}]], "Input",
 CellChangeTimes->{{3.617545317995997*^9, 3.6175453207495127`*^9}, {
   3.6175453819376373`*^9, 3.617545448440494*^9}, {3.6175460738866673`*^9, 
   3.6175460816064577`*^9}, 3.6175466387472553`*^9, {3.61754667567981*^9, 
   3.6175466903081007`*^9}, {3.6175943695191402`*^9, 3.617594376111363*^9}}],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   RowBox[{
    SubscriptBox["\[Del]", "i"], 
    SuperscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  $CellContext`CD3[-$CellContext`i][
   $CellContext`CD3[$CellContext`i][
    $CellContext`\[CurlyPhi][]]],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.6175453214175034`*^9, {3.617545375687696*^9, 3.6175454000433607`*^9}, 
   3.617545438031508*^9, 3.617545600423053*^9, 3.617545751485708*^9, 
   3.617545867181991*^9, 3.617545899848105*^9, 3.617546082243061*^9, 
   3.6175466398203783`*^9, {3.6175466761715813`*^9, 3.617546691402752*^9}, 
   3.617594377754344*^9, 3.617609310059901*^9, 3.618584634967898*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ByParts", "[", 
  RowBox[{"expr", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       StyleBox[
        RowBox[{
         SubscriptBox["\[Del]", "i"], 
         SuperscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`CD3[-$CellContext`i][
        $CellContext`CD3[$CellContext`i][
         $CellContext`\[CurlyPhi][]]],
       Editable->False], ",", 
      InterpretationBox[
       StyleBox[
        RowBox[{
         SubscriptBox["\[Del]", "i"], 
         SuperscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`CD3[-$CellContext`i][
        $CellContext`CD3[$CellContext`i][
         $CellContext`\[CurlyPhi][]]],
       Editable->False], ",", 
      RowBox[{"-", "i"}]}], "}"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQLeU/cfqUT68cQy5JzAbR/+10F4BoMzuBhSC6Lne9
+FQgPenuY2kQbVR533rD51eO047o2oBoG9ktnBuBtFp2EzeI9ilgEgDRq7Si
REB0niv/+a0g8SRPML2o7vikZ0B6UmrMdBB9mF/u6HMgnbVuP5h+q71Y+gWQ
jvispwCi07Jmu4HomHUNXiC6o79hCYgOPaC7HERrcd89CqIvuVieAtEpLxbf
B9FuG2c9A9F/ul2+gOisitW/QLTvpGPsL0H6fVu4QDQP27wwEM0h+ikKRCe4
r4kH0WJ56xJB9JesKJ3XQLrv5kYw3TRR3whE7/8kbA6id7F/ngGitzy9swhE
C4kFvQXRUWeiPoDoCB5N4zdA+sjUXnMQ7b62vpn5yyvHfXcNWkA0ADId5jQ=

  "]],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.617546115865593*^9, {3.617546653366761*^9, 3.6175466937702427`*^9}, {
   3.617594398692834*^9, 3.617594402048605*^9}, 3.617609310108131*^9, 
   3.618584635034876*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Example 3 - case with symmetry", "Subsection"]], \
"Subsection",
 CellChangeTimes->{{3.617546014190298*^9, 3.617546015832621*^9}, {
  3.617546045844542*^9, 3.617546045911034*^9}, {3.61754670449575*^9, 
  3.6175467045748453`*^9}, {3.617546959840509*^9, 3.617546963351096*^9}}],

Cell["\<\
When there is symmetry in the input term then the result is refactored \
appropriately:\
\>", "Text",
 CellChangeTimes->{{3.6175466147785673`*^9, 3.617546632297948*^9}, {
  3.617546697788888*^9, 3.617546754760695*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"\[CurlyPhi]", "[", "]"}], "5"], 
   RowBox[{
    RowBox[{"CD3", "[", 
     RowBox[{"-", "i"}], "]"}], "@", 
    RowBox[{"\[CurlyPhi]", "[", "]"}]}], 
   RowBox[{
    RowBox[{"CD3", "[", "i", "]"}], "@", 
    RowBox[{"\[CurlyPhi]", "[", "]"}], " "}]}]}]], "Input",
 CellChangeTimes->{{3.617545317995997*^9, 3.6175453207495127`*^9}, {
   3.6175453819376373`*^9, 3.617545448440494*^9}, {3.6175460738866673`*^9, 
   3.6175460816064577`*^9}, 3.6175466387472553`*^9, {3.61754667567981*^9, 
   3.6175466903081007`*^9}, {3.617546764135745*^9, 3.617546768326755*^9}, {
   3.617546843806547*^9, 3.617546861054778*^9}, {3.617594426169821*^9, 
   3.617594431919942*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   InterpretationBox[
    StyleBox["\[CurlyPhi]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CurlyPhi][],
    Editable->False], "5"], " ", 
  InterpretationBox[
   StyleBox[
    RowBox[{
     SubscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`CD3[-$CellContext`i][
    $CellContext`\[CurlyPhi][]],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    RowBox[{
     SuperscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`CD3[$CellContext`i][
    $CellContext`\[CurlyPhi][]],
   Editable->False]}]], "Output",
 CellChangeTimes->{
  3.6175453214175034`*^9, {3.617545375687696*^9, 3.6175454000433607`*^9}, 
   3.617545438031508*^9, 3.617545600423053*^9, 3.617545751485708*^9, 
   3.617545867181991*^9, 3.617545899848105*^9, 3.617546082243061*^9, 
   3.6175466398203783`*^9, {3.6175466761715813`*^9, 3.617546691402752*^9}, 
   3.617546769544899*^9, {3.617546845518821*^9, 3.61754686261907*^9}, 
   3.6175944338888617`*^9, 3.6176093101444902`*^9, 3.618584642858979*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ByParts", "[", 
  RowBox[{"expr", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        InterpretationBox[
         StyleBox["\[CurlyPhi]",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`\[CurlyPhi][],
         Editable->False], "5"], " ", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[-$CellContext`i][
         $CellContext`\[CurlyPhi][]],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SuperscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[$CellContext`i][
         $CellContext`\[CurlyPhi][]],
        Editable->False]}], ",", 
      InterpretationBox[
       StyleBox[
        RowBox[{
         SubscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`CD3[-$CellContext`i][
        $CellContext`\[CurlyPhi][]],
       Editable->False], ",", 
      RowBox[{"-", "i"}]}], "}"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIw7T9x+pRPrxxDLknMBtH/7XQXgGgzO4GFILoud734
VCA96e5jaRBtVHnfesPnV47TjujagGgb2S2cG4G0WnYTN4j2KWASANGrtKJE
QHSeK//5rSDxJE8wvaju+KRnQHpSasx0EH2YX+7ocyCdtW4/mH6rvVj6BZCO
+KynAKLTsma7geiYdQ1eILqjv2EJiA49oLscRGtx3z0Koi+5WJ4C0SkvFt8H
0W4bZz0D0X+6Xb6A6KyK1b9AtO+kY+wvQfp9W7hANA/bvDAQzSH6KQpEJ7iv
iQfRYnnrEkH0l6wonddAuu/mRjDdNFHfCETv/yRsDqJ3sX+eAaK3PL2zCEQL
iQW9BdFRZ6I+gOgIHk3jN0D6yNRecxB9pSjTGURXpPa4g/l/F/uA6OB9s/1A
9JJdup3MX1453lwysQtEAwCFZfsh
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "6"]}], " ", 
  SuperscriptBox[
   InterpretationBox[
    StyleBox["\[CurlyPhi]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CurlyPhi][],
    Editable->False], "6"], " ", 
  InterpretationBox[
   StyleBox[
    RowBox[{
     SubscriptBox["\[Del]", "i"], 
     SuperscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`CD3[-$CellContext`i][
    $CellContext`CD3[$CellContext`i][
     $CellContext`\[CurlyPhi][]]],
   Editable->False]}]], "Output",
 CellChangeTimes->{
  3.617546115865593*^9, {3.617546653366761*^9, 3.6175466937702427`*^9}, {
   3.617546798440469*^9, 3.6175468128710117`*^9}, {3.617546847804147*^9, 
   3.617546870042726*^9}, 3.617594454062871*^9, 3.617609310191927*^9, 
   3.618584642923932*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Example 4 - sequential integrations by parts", \
"Subsection"]], "Subsection",
 CellChangeTimes->{{3.617546014190298*^9, 3.617546015832621*^9}, {
  3.617546045844542*^9, 3.617546045911034*^9}, {3.61754670449575*^9, 
  3.6175467045748453`*^9}, {3.617546959840509*^9, 3.617547004040841*^9}}],

Cell["\<\
Same as example 3, but just integrate twice to recover the original result:\
\>", "Text",
 CellChangeTimes->{{3.6175466147785673`*^9, 3.617546632297948*^9}, {
  3.617546697788888*^9, 3.617546754760695*^9}, {3.6175470147420063`*^9, 
  3.617547031621216*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"\[CurlyPhi]", "[", "]"}], "5"], 
   RowBox[{
    RowBox[{"CD3", "[", 
     RowBox[{"-", "i"}], "]"}], "@", 
    RowBox[{"\[CurlyPhi]", "[", "]"}]}], 
   RowBox[{
    RowBox[{"CD3", "[", "i", "]"}], "@", 
    RowBox[{"\[CurlyPhi]", "[", "]"}], " "}]}]}]], "Input",
 CellChangeTimes->{{3.617545317995997*^9, 3.6175453207495127`*^9}, {
   3.6175453819376373`*^9, 3.617545448440494*^9}, {3.6175460738866673`*^9, 
   3.6175460816064577`*^9}, 3.6175466387472553`*^9, {3.61754667567981*^9, 
   3.6175466903081007`*^9}, {3.617546764135745*^9, 3.617546768326755*^9}, {
   3.617546843806547*^9, 3.617546861054778*^9}, {3.617594474061347*^9, 
   3.6175944801257467`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   InterpretationBox[
    StyleBox["\[CurlyPhi]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CurlyPhi][],
    Editable->False], "5"], " ", 
  InterpretationBox[
   StyleBox[
    RowBox[{
     SubscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`CD3[-$CellContext`i][
    $CellContext`\[CurlyPhi][]],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    RowBox[{
     SuperscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`CD3[$CellContext`i][
    $CellContext`\[CurlyPhi][]],
   Editable->False]}]], "Output",
 CellChangeTimes->{
  3.6175453214175034`*^9, {3.617545375687696*^9, 3.6175454000433607`*^9}, 
   3.617545438031508*^9, 3.617545600423053*^9, 3.617545751485708*^9, 
   3.617545867181991*^9, 3.617545899848105*^9, 3.617546082243061*^9, 
   3.6175466398203783`*^9, {3.6175466761715813`*^9, 3.617546691402752*^9}, 
   3.617546769544899*^9, {3.617546845518821*^9, 3.61754686261907*^9}, 
   3.617594481075488*^9, 3.6176093102419033`*^9, 3.6185846521341343`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ByParts", "[", 
  RowBox[{"expr", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        InterpretationBox[
         StyleBox["\[CurlyPhi]",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`\[CurlyPhi][],
         Editable->False], "5"], " ", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[-$CellContext`i][
         $CellContext`\[CurlyPhi][]],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SuperscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[$CellContext`i][
         $CellContext`\[CurlyPhi][]],
        Editable->False]}], ",", 
      InterpretationBox[
       StyleBox[
        RowBox[{
         SubscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`CD3[-$CellContext`i][
        $CellContext`\[CurlyPhi][]],
       Editable->False], ",", 
      RowBox[{"-", "i"}]}], "}"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.617547105486471*^9, {3.617594491506947*^9, 3.617594501861026*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "6"]}], " ", 
  SuperscriptBox[
   InterpretationBox[
    StyleBox["\[CurlyPhi]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CurlyPhi][],
    Editable->False], "6"], " ", 
  InterpretationBox[
   StyleBox[
    RowBox[{
     SubscriptBox["\[Del]", "i"], 
     SuperscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`CD3[-$CellContext`i][
    $CellContext`CD3[$CellContext`i][
     $CellContext`\[CurlyPhi][]]],
   Editable->False]}]], "Output",
 CellChangeTimes->{3.617547106272129*^9, 3.617594503566304*^9, 
  3.617609310291277*^9, 3.6185846522179213`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ByParts", "[", 
  RowBox[{"expr", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         InterpretationBox[
          StyleBox["\[CurlyPhi]",
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`\[CurlyPhi][],
          Editable->False], "5"], " ", 
        InterpretationBox[
         StyleBox[
          RowBox[{
           SubscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`CD3[-$CellContext`i][
          $CellContext`\[CurlyPhi][]],
         Editable->False], " ", 
        InterpretationBox[
         StyleBox[
          RowBox[{
           SuperscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`CD3[$CellContext`i][
          $CellContext`\[CurlyPhi][]],
         Editable->False]}], ",", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[-$CellContext`i][
         $CellContext`\[CurlyPhi][]],
        Editable->False], ",", 
       RowBox[{"-", "i"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "6"]}], " ", 
        SuperscriptBox[
         InterpretationBox[
          StyleBox["\[CurlyPhi]",
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`\[CurlyPhi][],
          Editable->False], "6"], " ", 
        InterpretationBox[
         StyleBox[
          RowBox[{
           SubscriptBox["\[Del]", "i"], 
           SuperscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`CD3[-$CellContext`i][
          $CellContext`CD3[$CellContext`i][
           $CellContext`\[CurlyPhi][]]],
         Editable->False]}], ",", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[Del]", "i"], 
          SuperscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[-$CellContext`i][
         $CellContext`CD3[$CellContext`i][
          $CellContext`\[CurlyPhi][]]],
        Editable->False], ",", 
       RowBox[{"-", "i"}]}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBmIQLeU/cfqUT68cQy5JzAbR/+10F4BoMzuBhSC6Lne9
+FQgPenuY2kQbVR533rD51eO047o2oBoG9ktnBuBtFp2EzeI9ilgEgDRq7Si
REB0niv/+a0g8SRPML2o7vikZ0B6UmrMdBB9mF/u6HMgnbVuP5h+q71Y+gWQ
jvispwCi07Jmu4HomHUNXiC6o79hCYgOPaC7HERrcd89CqIvuVieAtEpLxbf
B9FuG2c9A9F/ul2+gOisitW/QLTvpGPsL0H6fVu4QDQP27wwEM0h+ikKRCe4
r4kH0WJ56xJB9JesKJ3XQLrv5kYw3TRR3whE7/8kbA6id7F/ngGitzy9swhE
C4kFvQXRUWeiPoDoCB5N4zdA+sjUXnMQfaUo0xlEV6T2uIP5fxf7gOjgfbP9
QHRV8uNkEG3nUpsBojtmvZ/I/AWo/rf4VBANAJpBBOQ=
  "]],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   InterpretationBox[
    StyleBox["\[CurlyPhi]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[CurlyPhi][],
    Editable->False], "5"], " ", 
  InterpretationBox[
   StyleBox[
    RowBox[{
     SubscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`CD3[-$CellContext`i][
    $CellContext`\[CurlyPhi][]],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    RowBox[{
     SuperscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`CD3[$CellContext`i][
    $CellContext`\[CurlyPhi][]],
   Editable->False]}]], "Output",
 CellChangeTimes->{
  3.617546115865593*^9, {3.617546653366761*^9, 3.6175466937702427`*^9}, {
   3.617546798440469*^9, 3.6175468128710117`*^9}, {3.617546847804147*^9, 
   3.617546870042726*^9}, {3.617547047581431*^9, 3.6175470878613586`*^9}, 
   3.617594539566457*^9, 3.6176093103416224`*^9, 3.6185846522513447`*^9}]
}, Open  ]],

Cell[TextData[{
 "This example also serves to explain how to use the ByParts function: Take \
the output from one integration by parts, decide which term you want to \
integrate, copy and paste that as a new entry in the second argument of the \
Byparts function, copy and paste the bit of that term that you want to \
integrate, and then type in the relevant indice. Then run the ByParts \
function again, and repeat to your heart\[CloseCurlyQuote]s content. This \
procedure neatly avoids having to type out any long expressions. \n\nNote \
that copying and pasting can be a bit fiddly in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " since when one selects the output of an expression one sometimes does not \
select all of the invisible but necessary parts of the expression. Rule of \
thumb: if you get unexpected errors, try copying and pasting again."
}], "Text",
 CellChangeTimes->{{3.617547152475072*^9, 3.6175474860239897`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Example 5 - more than two nested covariant \
derivatives", "Subsection"]], "Subsection",
 CellChangeTimes->{{3.617546014190298*^9, 3.617546015832621*^9}, {
  3.617546045844542*^9, 3.617546045911034*^9}, {3.61754670449575*^9, 
  3.6175467045748453`*^9}, {3.617546959840509*^9, 3.617546963351096*^9}, {
  3.617594588854651*^9, 3.617594613570994*^9}}],

Cell["\<\
When integrating by parts, ByParts first ensures that the derivative to be \
moved is commuted outside of any other derivatives that share the same \
character. Derivatives are presumed to commute if they are not of the same \
type (in the worst case scenario where one is dealing with multiple covariant \
derivatives defined on the same space then it may be necessary to expand \
these out into mutually commuting partial derivatives before integrating by \
parts). This commutation leads to the generation of curvature terms as \
appropriate. The commutation is done by the function CovDToTop which is also \
part of this package.\
\>", "Text",
 CellChangeTimes->{{3.6175466147785673`*^9, 3.617546632297948*^9}, {
  3.617546697788888*^9, 3.617546754760695*^9}, {3.6175946226855297`*^9, 
  3.61759482755221*^9}, {3.6175948901980267`*^9, 3.6175949351826057`*^9}, {
  3.6175958997474613`*^9, 3.617595923575101*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"ChristoffelCD3", "[", 
    RowBox[{"i", ",", "j", ",", "k"}], "]"}], " ", 
   RowBox[{
    RowBox[{"CD3", "[", 
     RowBox[{"-", "i"}], "]"}], "@", 
    RowBox[{
     RowBox[{"CD3", "[", 
      RowBox[{"-", "j"}], "]"}], "@", 
     RowBox[{
      RowBox[{"CD3", "[", 
       RowBox[{"-", "k"}], "]"}], "@", 
      RowBox[{"\[CurlyPhi]", "[", "]"}], " "}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.617545317995997*^9, 3.6175453207495127`*^9}, {
   3.6175453819376373`*^9, 3.617545448440494*^9}, {3.6175460738866673`*^9, 
   3.6175460816064577`*^9}, 3.6175466387472553`*^9, {3.61754667567981*^9, 
   3.6175466903081007`*^9}, {3.617546764135745*^9, 3.617546768326755*^9}, {
   3.617546843806547*^9, 3.617546861054778*^9}, {3.617594426169821*^9, 
   3.617594431919942*^9}, {3.617594940722391*^9, 3.6175949601885567`*^9}, {
   3.617595058625217*^9, 3.617595065016714*^9}, {3.617595314506857*^9, 
   3.6175953485006313`*^9}, {3.617595444088738*^9, 3.617595450898584*^9}}],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[GridBox[{
      {
       RowBox[{"\[CapitalGamma]", "[", "\[Del]", "]"}], 
       StyleBox[GridBox[{
          {"i", "j", "k"},
          {" ", " ", " "}
         },
         GridBoxSpacings->{"Columns" -> {
             Offset[0.], {
              Offset[0.034999999999999996`]}, 
             Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
              Offset[0.]}}, "RowsIndexed" -> {}}],
        FontSize->9]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.034999999999999996`]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`ChristoffelCD3[$CellContext`i, $CellContext`j, $CellContext`k],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    RowBox[{
     SubscriptBox["\[Del]", "i"], 
     SubscriptBox["\[Del]", "j"], 
     SubscriptBox["\[Del]", "k"], "\[CurlyPhi]"}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`CD3[-$CellContext`i][
    $CellContext`CD3[-$CellContext`j][
     $CellContext`CD3[-$CellContext`k][
      $CellContext`\[CurlyPhi][]]]],
   Editable->False]}]], "Output",
 CellChangeTimes->{
  3.6175453214175034`*^9, {3.617545375687696*^9, 3.6175454000433607`*^9}, 
   3.617545438031508*^9, 3.617545600423053*^9, 3.617545751485708*^9, 
   3.617545867181991*^9, 3.617545899848105*^9, 3.617546082243061*^9, 
   3.6175466398203783`*^9, {3.6175466761715813`*^9, 3.617546691402752*^9}, 
   3.617546769544899*^9, {3.617546845518821*^9, 3.61754686261907*^9}, 
   3.6175944338888617`*^9, 3.617594960704463*^9, 3.617595065497012*^9, 
   3.617595353123742*^9, 3.617595451939458*^9, 3.6176093103918037`*^9, 
   3.618584658340382*^9}]
}, Open  ]],

Cell["\<\
Integrating by parts with the first derivative requires no commutation and \
threfore no curvature terms are introduced:\
\>", "Text",
 CellChangeTimes->{{3.617595001668559*^9, 3.617595035464931*^9}, {
  3.617595490530943*^9, 3.6175954918750057`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ByParts", "[", 
  RowBox[{"expr", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        StyleBox[GridBox[{
           {
            RowBox[{"\[CapitalGamma]", "[", "\[Del]", "]"}], 
            StyleBox[GridBox[{
               {"i", "j", "k"},
               {" ", " ", " "}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.], {
                   Offset[0.034999999999999996`]}, 
                  Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                   Offset[0.]}}, "RowsIndexed" -> {}}],
             FontSize->9]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Center}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.034999999999999996`]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`ChristoffelCD3[$CellContext`i, $CellContext`j, \
$CellContext`k],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[Del]", "i"], 
          SubscriptBox["\[Del]", "j"], 
          SubscriptBox["\[Del]", "k"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[-$CellContext`i][
         $CellContext`CD3[-$CellContext`j][
          $CellContext`CD3[-$CellContext`k][
           $CellContext`\[CurlyPhi][]]]],
        Editable->False]}], ",", 
      StyleBox[
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[Del]", "i"], 
          SubscriptBox["\[Del]", "j"], 
          SubscriptBox["\[Del]", "k"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[-$CellContext`i][
         $CellContext`CD3[-$CellContext`j][
          $CellContext`CD3[-$CellContext`k][
           $CellContext`\[CurlyPhi][]]]],
        Editable->False],
       ShowAutoStyles->False,
       AutoSpacing->False], ",", 
      RowBox[{"-", "i"}]}], "}"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.616842940540906*^9, 3.616842968775675*^9}, {
   3.61684300941394*^9, 3.616843016507594*^9}, {3.6168439654821157`*^9, 
   3.616843999120797*^9}, {3.6174238389835443`*^9, 3.6174238414302473`*^9}, {
   3.6174254856285686`*^9, 3.6174255000755796`*^9}, {3.617425536076208*^9, 
   3.617425570817708*^9}, {3.6174352564772253`*^9, 3.617435258293249*^9}, {
   3.617535126234208*^9, 3.6175351628873987`*^9}, {3.617537576939424*^9, 
   3.617537581990041*^9}, {3.617538269099112*^9, 3.617538305467205*^9}, {
   3.617538612856738*^9, 3.617538644021284*^9}, {3.617539364017521*^9, 
   3.617539385429728*^9}, {3.617539630907613*^9, 3.617539665789651*^9}, {
   3.617539837122118*^9, 3.61753989283414*^9}, {3.617540002142088*^9, 
   3.617540053358449*^9}, {3.617540158205359*^9, 3.61754018013444*^9}, {
   3.617540788938238*^9, 3.6175408235650673`*^9}, {3.617540861383713*^9, 
   3.617540877450938*^9}, {3.617544546825556*^9, 3.617544549557807*^9}, {
   3.617544593486512*^9, 3.617544632623382*^9}, {3.617545415594693*^9, 
   3.61754549490304*^9}, {3.617546090565194*^9, 3.6175461148374453`*^9}, {
   3.617546649282757*^9, 3.617546684424532*^9}, {3.617546779295267*^9, 
   3.6175468123873863`*^9}, {3.617546853124735*^9, 3.617546868866983*^9}, {
   3.6175944414290333`*^9, 3.617594452551373*^9}, {3.617594972897109*^9, 
   3.617594989637138*^9}, {3.6175950722580853`*^9, 3.6175951154443083`*^9}, {
   3.6175953679825373`*^9, 3.6175953761837482`*^9}, 3.617595460220304*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "i"], GridBox[{
        {
         RowBox[{"\[CapitalGamma]", "[", "\[Del]", "]"}], 
         StyleBox[GridBox[{
            {"i", "j", "k"},
            {" ", " ", " "}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->9]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[-$CellContext`i][
     $CellContext`ChristoffelCD3[$CellContext`i, $CellContext`j, \
$CellContext`k]],
    Editable->False]}], " ", 
  InterpretationBox[
   StyleBox[
    RowBox[{
     SubscriptBox["\[Del]", "k"], 
     SubscriptBox["\[Del]", "j"], "\[CurlyPhi]"}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`CD3[-$CellContext`k][
    $CellContext`CD3[-$CellContext`j][
     $CellContext`\[CurlyPhi][]]],
   Editable->False]}]], "Output",
 CellChangeTimes->{3.61759511652728*^9, 3.6175953789546633`*^9, 
  3.617595462306902*^9, 3.6176093104274483`*^9, 3.618584658423389*^9}]
}, Open  ]],

Cell["\<\
Whereas integrating by parts with respect to either of the other indices \
(which are equivalent since these derivatives are a symmetric product acting \
on a scalar) generates an additional curvature tensor term.\
\>", "Text",
 CellChangeTimes->{{3.617595498549024*^9, 3.617595592534964*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ByParts", "[", 
  RowBox[{"expr", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        StyleBox[GridBox[{
           {
            RowBox[{"\[CapitalGamma]", "[", "\[Del]", "]"}], 
            StyleBox[GridBox[{
               {"i", "j", "k"},
               {" ", " ", " "}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.], {
                   Offset[0.034999999999999996`]}, 
                  Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                   Offset[0.]}}, "RowsIndexed" -> {}}],
             FontSize->9]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Center}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.034999999999999996`]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`ChristoffelCD3[$CellContext`i, $CellContext`j, \
$CellContext`k],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[Del]", "i"], 
          SubscriptBox["\[Del]", "j"], 
          SubscriptBox["\[Del]", "k"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[-$CellContext`i][
         $CellContext`CD3[-$CellContext`j][
          $CellContext`CD3[-$CellContext`k][
           $CellContext`\[CurlyPhi][]]]],
        Editable->False]}], ",", 
      StyleBox[
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[Del]", "i"], 
          SubscriptBox["\[Del]", "j"], 
          SubscriptBox["\[Del]", "k"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[-$CellContext`i][
         $CellContext`CD3[-$CellContext`j][
          $CellContext`CD3[-$CellContext`k][
           $CellContext`\[CurlyPhi][]]]],
        Editable->False],
       ShowAutoStyles->False,
       AutoSpacing->False], ",", 
      RowBox[{"-", "j"}]}], "}"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.616842940540906*^9, 3.616842968775675*^9}, {
   3.61684300941394*^9, 3.616843016507594*^9}, {3.6168439654821157`*^9, 
   3.616843999120797*^9}, {3.6174238389835443`*^9, 3.6174238414302473`*^9}, {
   3.6174254856285686`*^9, 3.6174255000755796`*^9}, {3.617425536076208*^9, 
   3.617425570817708*^9}, {3.6174352564772253`*^9, 3.617435258293249*^9}, {
   3.617535126234208*^9, 3.6175351628873987`*^9}, {3.617537576939424*^9, 
   3.617537581990041*^9}, {3.617538269099112*^9, 3.617538305467205*^9}, {
   3.617538612856738*^9, 3.617538644021284*^9}, {3.617539364017521*^9, 
   3.617539385429728*^9}, {3.617539630907613*^9, 3.617539665789651*^9}, {
   3.617539837122118*^9, 3.61753989283414*^9}, {3.617540002142088*^9, 
   3.617540053358449*^9}, {3.617540158205359*^9, 3.61754018013444*^9}, {
   3.617540788938238*^9, 3.6175408235650673`*^9}, {3.617540861383713*^9, 
   3.617540877450938*^9}, {3.617544546825556*^9, 3.617544549557807*^9}, {
   3.617544593486512*^9, 3.617544632623382*^9}, {3.617545415594693*^9, 
   3.61754549490304*^9}, {3.617546090565194*^9, 3.6175461148374453`*^9}, {
   3.617546649282757*^9, 3.617546684424532*^9}, {3.617546779295267*^9, 
   3.6175468123873863`*^9}, {3.617546853124735*^9, 3.617546868866983*^9}, {
   3.6175944414290333`*^9, 3.617594452551373*^9}, {3.617594972897109*^9, 
   3.617594989637138*^9}, 3.617595049455076*^9, {3.617595125358526*^9, 
   3.6175951492233343`*^9}, {3.6175952498818827`*^9, 3.617595250817919*^9}, {
   3.61759547169203*^9, 3.6175954749386578`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    InterpretationBox[
     StyleBox[
      RowBox[{
       SubscriptBox["\[Del]", "i"], 
       SubscriptBox["\[Del]", "k"], "\[CurlyPhi]"}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`CD3[-$CellContext`i][
      $CellContext`CD3[-$CellContext`k][
       $CellContext`\[CurlyPhi][]]],
     Editable->False]}], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "j"], GridBox[{
        {
         RowBox[{"\[CapitalGamma]", "[", "\[Del]", "]"}], 
         StyleBox[GridBox[{
            {"i", "j", "k"},
            {" ", " ", " "}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->9]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[-$CellContext`j][
     $CellContext`ChristoffelCD3[$CellContext`i, $CellContext`j, \
$CellContext`k]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[GridBox[{
       {
        RowBox[{"\[CapitalGamma]", "[", "\[Del]", "]"}], 
        StyleBox[GridBox[{
           {"i", "j", "k"},
           {" ", " ", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->9]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`ChristoffelCD3[$CellContext`i, $CellContext`j, \
$CellContext`k],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {
        RowBox[{"R", "[", "\[Del]", "]"}], 
        StyleBox[GridBox[{
           {" ", " ", " ", "l"},
           {"i", "j", "k", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->9]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`RiemannCD3[-$CellContext`i, -$CellContext`j, \
-$CellContext`k, $CellContext`l],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "l"], "\[CurlyPhi]"}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[-$CellContext`l][
     $CellContext`\[CurlyPhi][]],
    Editable->False]}]}]], "Output",
 CellChangeTimes->{
  3.617546115865593*^9, {3.617546653366761*^9, 3.6175466937702427`*^9}, {
   3.617546798440469*^9, 3.6175468128710117`*^9}, {3.617546847804147*^9, 
   3.617546870042726*^9}, 3.617594454062871*^9, 3.6175949911272087`*^9, 
   3.617595049833685*^9, {3.617595130558926*^9, 3.617595149702301*^9}, 
   3.617595251368116*^9, 3.617595475480098*^9, 3.617609310475998*^9, 
   3.6185846584584312`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ByParts", "[", 
  RowBox[{"expr", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        StyleBox[GridBox[{
           {
            RowBox[{"\[CapitalGamma]", "[", "\[Del]", "]"}], 
            StyleBox[GridBox[{
               {"i", "j", "k"},
               {" ", " ", " "}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.], {
                   Offset[0.034999999999999996`]}, 
                  Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                   Offset[0.]}}, "RowsIndexed" -> {}}],
             FontSize->9]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Center}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.034999999999999996`]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`ChristoffelCD3[$CellContext`i, $CellContext`j, \
$CellContext`k],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[Del]", "i"], 
          SubscriptBox["\[Del]", "j"], 
          SubscriptBox["\[Del]", "k"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[-$CellContext`i][
         $CellContext`CD3[-$CellContext`j][
          $CellContext`CD3[-$CellContext`k][
           $CellContext`\[CurlyPhi][]]]],
        Editable->False]}], ",", 
      StyleBox[
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[Del]", "i"], 
          SubscriptBox["\[Del]", "j"], 
          SubscriptBox["\[Del]", "k"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[-$CellContext`i][
         $CellContext`CD3[-$CellContext`j][
          $CellContext`CD3[-$CellContext`k][
           $CellContext`\[CurlyPhi][]]]],
        Editable->False],
       ShowAutoStyles->False,
       AutoSpacing->False], ",", 
      RowBox[{"-", "k"}]}], "}"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.617595194429793*^9, 3.617595284762395*^9}, {
  3.6175954819657373`*^9, 3.617595484052861*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    InterpretationBox[
     StyleBox[
      RowBox[{
       SubscriptBox["\[Del]", "i"], 
       SubscriptBox["\[Del]", "k"], "\[CurlyPhi]"}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`CD3[-$CellContext`i][
      $CellContext`CD3[-$CellContext`k][
       $CellContext`\[CurlyPhi][]]],
     Editable->False]}], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "j"], GridBox[{
        {
         RowBox[{"\[CapitalGamma]", "[", "\[Del]", "]"}], 
         StyleBox[GridBox[{
            {"i", "j", "k"},
            {" ", " ", " "}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->9]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[-$CellContext`j][
     $CellContext`ChristoffelCD3[$CellContext`i, $CellContext`j, \
$CellContext`k]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[GridBox[{
       {
        RowBox[{"\[CapitalGamma]", "[", "\[Del]", "]"}], 
        StyleBox[GridBox[{
           {"i", "j", "k"},
           {" ", " ", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->9]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`ChristoffelCD3[$CellContext`i, $CellContext`j, \
$CellContext`k],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {
        RowBox[{"R", "[", "\[Del]", "]"}], 
        StyleBox[GridBox[{
           {" ", " ", " ", "l"},
           {"i", "j", "k", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->9]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`RiemannCD3[-$CellContext`i, -$CellContext`j, \
-$CellContext`k, $CellContext`l],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "l"], "\[CurlyPhi]"}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[-$CellContext`l][
     $CellContext`\[CurlyPhi][]],
    Editable->False]}]}]], "Output",
 CellChangeTimes->{{3.617595217794726*^9, 3.6175952852494926`*^9}, 
   3.617595484448174*^9, 3.617609310526311*^9, 3.618584658552135*^9}]
}, Open  ]],

Cell["\<\
ByParts commutes indices multiple times in order to move the chosen \
derivative to the outside of the expression\
\>", "Text",
 CellChangeTimes->{{3.617595601625285*^9, 3.6175956767557697`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"CD3", "[", "m", "]"}], "@", 
    RowBox[{"RiemannCD3", "[", 
     RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}]}], " ", 
   RowBox[{
    RowBox[{"CD3", "[", 
     RowBox[{"-", "i"}], "]"}], "@", 
    RowBox[{
     RowBox[{"CD3", "[", 
      RowBox[{"-", "j"}], "]"}], "@", 
     RowBox[{
      RowBox[{"CD3", "[", 
       RowBox[{"-", "k"}], "]"}], "@", 
      RowBox[{
       RowBox[{"CD3", "[", 
        RowBox[{"-", "l"}], "]"}], "@", 
       RowBox[{
        RowBox[{"CD3", "[", 
         RowBox[{"-", "m"}], "]"}], "@", 
        RowBox[{"\[CurlyPhi]", "[", "]"}], " "}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.617595700844678*^9, 3.617595734536189*^9}}],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   StyleBox[
    RowBox[{
     SubscriptBox["\[Del]", "i"], 
     SubscriptBox["\[Del]", "j"], 
     SubscriptBox["\[Del]", "k"], 
     SubscriptBox["\[Del]", "l"], 
     SubscriptBox["\[Del]", "m"], "\[CurlyPhi]"}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`CD3[-$CellContext`i][
    $CellContext`CD3[-$CellContext`j][
     $CellContext`CD3[-$CellContext`k][
      $CellContext`CD3[-$CellContext`l][
       $CellContext`CD3[-$CellContext`m][
        $CellContext`\[CurlyPhi][]]]]]],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    RowBox[{
     SuperscriptBox["\[Del]", "m"], GridBox[{
       {
        RowBox[{"R", "[", "\[Del]", "]"}], 
        StyleBox[GridBox[{
           {"i", "j", "k", "l"},
           {" ", " ", " ", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->9]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}]}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`CD3[$CellContext`m][
    $CellContext`RiemannCD3[$CellContext`i, $CellContext`j, $CellContext`k, \
$CellContext`l]],
   Editable->False]}]], "Output",
 CellChangeTimes->{3.6175957356716223`*^9, 3.617609310575775*^9, 
  3.618584658608013*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ByParts", "[", 
  RowBox[{"expr", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[Del]", "i"], 
          SubscriptBox["\[Del]", "j"], 
          SubscriptBox["\[Del]", "k"], 
          SubscriptBox["\[Del]", "l"], 
          SubscriptBox["\[Del]", "m"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[-$CellContext`i][
         $CellContext`CD3[-$CellContext`j][
          $CellContext`CD3[-$CellContext`k][
           $CellContext`CD3[-$CellContext`l][
            $CellContext`CD3[-$CellContext`m][
             $CellContext`\[CurlyPhi][]]]]]],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SuperscriptBox["\[Del]", "m"], GridBox[{
            {
             RowBox[{"R", "[", "\[Del]", "]"}], 
             StyleBox[GridBox[{
                {"i", "j", "k", "l"},
                {" ", " ", " ", " "}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                   Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                    Offset[0.]}}, "RowsIndexed" -> {}}],
              FontSize->9]}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Center}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.034999999999999996`]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}]}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[$CellContext`m][
         $CellContext`RiemannCD3[$CellContext`i, $CellContext`j, \
$CellContext`k, $CellContext`l]],
        Editable->False]}], ",", 
      StyleBox[
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[Del]", "i"], 
          SubscriptBox["\[Del]", "j"], 
          SubscriptBox["\[Del]", "k"], 
          SubscriptBox["\[Del]", "l"], 
          SubscriptBox["\[Del]", "m"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`CD3[-$CellContext`i][
         $CellContext`CD3[-$CellContext`j][
          $CellContext`CD3[-$CellContext`k][
           $CellContext`CD3[-$CellContext`l][
            $CellContext`CD3[-$CellContext`m][
             $CellContext`\[CurlyPhi][]]]]]],
        Editable->False],
       ShowAutoStyles->False,
       AutoSpacing->False], ",", 
      RowBox[{"-", "l"}]}], "}"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.617595751208097*^9, 3.6175958113214703`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    InterpretationBox[
     StyleBox[
      RowBox[{
       SubscriptBox["\[Del]", "i"], 
       SuperscriptBox["\[Del]", "m"], GridBox[{
         {
          RowBox[{"R", "[", "\[Del]", "]"}], 
          StyleBox[GridBox[{
             {"i", "j", "k", "l"},
             {" ", " ", " ", " "}
            },
            GridBoxSpacings->{"Columns" -> {
                Offset[0.], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                 Offset[0.]}}, "RowsIndexed" -> {}}],
           FontSize->9]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Center}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.034999999999999996`]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}]}],
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`CD3[-$CellContext`i][
      $CellContext`CD3[$CellContext`m][
       $CellContext`RiemannCD3[$CellContext`i, $CellContext`j, \
$CellContext`k, $CellContext`l]]],
     Editable->False]}], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "l"], 
      SubscriptBox["\[Del]", "k"], 
      SubscriptBox["\[Del]", "j"], 
      SubscriptBox["\[Del]", "m"], "\[CurlyPhi]"}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[-$CellContext`l][
     $CellContext`CD3[-$CellContext`k][
      $CellContext`CD3[-$CellContext`j][
       $CellContext`CD3[-$CellContext`m][
        $CellContext`\[CurlyPhi][]]]]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "j"], GridBox[{
        {
         RowBox[{"R", "[", "\[Del]", "]"}], 
         StyleBox[GridBox[{
            {" ", " ", " ", "n"},
            {"i", "k", "m", " "}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->9]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[-$CellContext`j][
     $CellContext`RiemannCD3[-$CellContext`i, -$CellContext`k, \
-$CellContext`m, $CellContext`n]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "l"], 
      SubscriptBox["\[Del]", "n"], "\[CurlyPhi]"}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[-$CellContext`l][
     $CellContext`CD3[-$CellContext`n][
      $CellContext`\[CurlyPhi][]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SuperscriptBox["\[Del]", "m"], GridBox[{
        {
         RowBox[{"R", "[", "\[Del]", "]"}], 
         StyleBox[GridBox[{
            {"i", "j", "k", "l"},
            {" ", " ", " ", " "}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->9]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[$CellContext`m][
     $CellContext`RiemannCD3[$CellContext`i, $CellContext`j, $CellContext`k, \
$CellContext`l]],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    StyleBox[GridBox[{
       {
        RowBox[{"R", "[", "\[Del]", "]"}], 
        StyleBox[GridBox[{
           {"i", "j", "k", "l"},
           {" ", " ", " ", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->9]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`RiemannCD3[$CellContext`i, $CellContext`j, $CellContext`k, \
$CellContext`l],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "k"], GridBox[{
        {
         RowBox[{"R", "[", "\[Del]", "]"}], 
         StyleBox[GridBox[{
            {" ", " ", "m", "n"},
            {"i", "j", " ", " "}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->9]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[-$CellContext`k][
     $CellContext`RiemannCD3[-$CellContext`i, -$CellContext`j, \
$CellContext`m, $CellContext`n]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "n"], 
      SubscriptBox["\[Del]", "m"], 
      SubscriptBox["\[Del]", "l"], "\[CurlyPhi]"}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[-$CellContext`n][
     $CellContext`CD3[-$CellContext`m][
      $CellContext`CD3[-$CellContext`l][
       $CellContext`\[CurlyPhi][]]]],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "l"], 
      SubscriptBox["\[Del]", "n"], "\[CurlyPhi]"}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[-$CellContext`l][
     $CellContext`CD3[-$CellContext`n][
      $CellContext`\[CurlyPhi][]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SuperscriptBox["\[Del]", "m"], GridBox[{
        {
         RowBox[{"R", "[", "\[Del]", "]"}], 
         StyleBox[GridBox[{
            {"i", "j", "k", "l"},
            {" ", " ", " ", " "}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->9]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[$CellContext`m][
     $CellContext`RiemannCD3[$CellContext`i, $CellContext`j, $CellContext`k, \
$CellContext`l]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SuperscriptBox["\[Del]", "n"], GridBox[{
        {
         RowBox[{"R", "[", "\[Del]", "]"}], 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"i", "k", "j", "m"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->9]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[$CellContext`n][
     $CellContext`RiemannCD3[-$CellContext`i, -$CellContext`k, \
-$CellContext`j, -$CellContext`m]],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    StyleBox[GridBox[{
       {
        RowBox[{"R", "[", "\[Del]", "]"}], 
        StyleBox[GridBox[{
           {"i", "j", "k", "l"},
           {" ", " ", " ", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->9]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`RiemannCD3[$CellContext`i, $CellContext`j, $CellContext`k, \
$CellContext`l],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "l"], 
      SubscriptBox["\[Del]", "m"], 
      SubscriptBox["\[Del]", "n"], "\[CurlyPhi]"}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[-$CellContext`l][
     $CellContext`CD3[-$CellContext`m][
      $CellContext`CD3[-$CellContext`n][
       $CellContext`\[CurlyPhi][]]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SuperscriptBox["\[Del]", "n"], GridBox[{
        {
         RowBox[{"R", "[", "\[Del]", "]"}], 
         StyleBox[GridBox[{
            {" ", " ", " ", "m"},
            {"i", "k", "j", " "}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->9]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[$CellContext`n][
     $CellContext`RiemannCD3[-$CellContext`i, -$CellContext`k, \
-$CellContext`j, $CellContext`m]],
    Editable->False]}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox[
     RowBox[{
      SuperscriptBox["\[Del]", "i"], "\[CurlyPhi]"}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[$CellContext`i][
     $CellContext`\[CurlyPhi][]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "m"], 
      SubscriptBox["\[Del]", "l"], GridBox[{
        {
         RowBox[{"R", "[", "\[Del]", "]"}], 
         StyleBox[GridBox[{
            {" ", " ", " ", " "},
            {"i", "n", "j", "k"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->9]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[-$CellContext`m][
     $CellContext`CD3[-$CellContext`l][
      $CellContext`RiemannCD3[-$CellContext`i, -$CellContext`n, \
-$CellContext`j, -$CellContext`k]]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SuperscriptBox["\[Del]", "n"], GridBox[{
        {
         RowBox[{"R", "[", "\[Del]", "]"}], 
         StyleBox[GridBox[{
            {"j", "k", "l", "m"},
            {" ", " ", " ", " "}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->9]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`CD3[$CellContext`n][
     $CellContext`RiemannCD3[$CellContext`j, $CellContext`k, $CellContext`l, \
$CellContext`m]],
    Editable->False]}]}]], "Output",
 CellChangeTimes->{{3.617595759308477*^9, 3.617595811953463*^9}, 
   3.6176093107400723`*^9, 3.618584658770259*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Basic examples using the fiducial partial derivative PD and ParamDs\
\>", "Section",
 CellChangeTimes->{{3.617545966164856*^9, 3.617545986663301*^9}, {
  3.617595947981593*^9, 3.6175959499736032`*^9}, {3.617606996271976*^9, 
  3.6176069985521803`*^9}}],

Cell["\<\
Integration by parts with partial derivatives could in principle be more \
complex than dealing with covariant derivatives because the contravariant and \
covariant forms of the derivatives are different. Further, one cannot use the \
xTensor function CommuteCovDs to commute PD derivatives. A resolution which \
makes the whole process more intuitive (and easier to code!) is to require \
that partial derivatives are only allowed if their indices are down. This can \
be achieved by applying the function SeparateMetric[] to the expression first.\
\>", "Text",
 CellChangeTimes->{{3.617595957768663*^9, 3.617595998142374*^9}, {
  3.6175963112602577`*^9, 3.6175965107128897`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Configure the function ToCanonical for partial derivatives\
\>", "Subsection",
 CellChangeTimes->{{3.616840789388999*^9, 3.6168407902743807`*^9}, {
  3.617545113279117*^9, 3.6175451327242527`*^9}, {3.617545930559195*^9, 
  3.6175459552588873`*^9}, {3.617545992653026*^9, 3.617545995667635*^9}, {
  3.617596528336193*^9, 3.617596537887224*^9}, {3.617606818520979*^9, 
  3.617606824006775*^9}}],

Cell["\<\
Since we will be working with expressions that use partial derivatives PD, we \
must change the options for the xTensor function ToCanonical as follows. This \
is needed because ByParts makes internal calls to the ToCanonical function.\
\>", "Text",
 CellChangeTimes->{{3.617546225897112*^9, 3.6175463272271767`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ToCanonical", ",", 
    RowBox[{"UseMetricOnVBundle", "\[Rule]", "None"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.617545690175915*^9, 3.617545703168084*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Example 1", "Subsection"]], "Subsection",
 CellChangeTimes->{{3.617546014190298*^9, 3.617546015832621*^9}, {
  3.6175469728710413`*^9, 3.617546978621099*^9}, {3.617596589422937*^9, 
  3.617596589871252*^9}}],

Cell["\<\
For example, let us integrate the Laplacian.\
\>", "Text",
 CellChangeTimes->{{3.617596736383911*^9, 3.6175967638635893`*^9}, {
  3.617596807652516*^9, 3.617596824958729*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"PD", "[", 
    RowBox[{"-", "i"}], "]"}], "@", 
   RowBox[{
    RowBox[{"PD", "[", "i", "]"}], "@", 
    RowBox[{"\[CurlyPhi]", "[", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.617545317995997*^9, 3.6175453207495127`*^9}, {
   3.6175453819376373`*^9, 3.617545448440494*^9}, {3.6175485859754057`*^9, 
   3.6175486053235617`*^9}, {3.617596599996043*^9, 3.617596640076076*^9}, {
   3.617596701074682*^9, 3.617596704170718*^9}, 3.617596747351111*^9}],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   RowBox[{
    SubscriptBox["\[PartialD]", "i"], 
    SuperscriptBox["\[PartialD]", "i"], "\[CurlyPhi]"}],
   ShowAutoStyles->False,
   AutoSpacing->False],
  xAct`xTensor`PD[-$CellContext`i][
   xAct`xTensor`PD[$CellContext`i][
    $CellContext`\[CurlyPhi][]]],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.6175453214175034`*^9, {3.617545375687696*^9, 3.6175454000433607`*^9}, 
   3.617545438031508*^9, 3.617545600423053*^9, 3.617545751485708*^9, 
   3.617545867181991*^9, 3.617545899848105*^9, 3.617548533447926*^9, {
   3.617548597577012*^9, 3.617548605584968*^9}, {3.617596612299876*^9, 
   3.6175966404491863`*^9}, 3.6175967052502537`*^9, 3.617596747945537*^9, 
   3.6175972226994534`*^9, {3.617597259149415*^9, 3.617597286081328*^9}, 
   3.617597344254911*^9, {3.617606658189445*^9, 3.617606683569528*^9}, 
   3.617606743206867*^9, 3.617609313021315*^9, 3.618584682213172*^9}]
}, Open  ]],

Cell["\<\
This is trivially zero, so the extra term that we get when we lower the \
partial derivatives must be cancelled when we perform the integration by \
parts:\
\>", "Text",
 CellChangeTimes->{{3.6175968279130173`*^9, 3.617596900331545*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"expr", "//", 
     RowBox[{"SeparateMetric", "[", "]"}]}], "//", "ScreenDollarIndices"}], "//",
    "Expand"}]}]], "Input",
 CellChangeTimes->{{3.617596710572461*^9, 3.617596711201324*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    StyleBox[GridBox[{
       {"h", 
        StyleBox[GridBox[{
           {"i", "j"},
           {" ", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->9]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`h[$CellContext`i, $CellContext`j],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[PartialD]", "i"], 
      SubscriptBox["\[PartialD]", "j"], "\[CurlyPhi]"}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    xAct`xTensor`PD[-$CellContext`i][
     xAct`xTensor`PD[-$CellContext`j][
      $CellContext`\[CurlyPhi][]]],
    Editable->False]}], "-", 
  RowBox[{
   InterpretationBox[
    StyleBox[GridBox[{
       {"h", 
        StyleBox[GridBox[{
           {"i", "k"},
           {" ", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->9]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`h[$CellContext`i, $CellContext`k],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[GridBox[{
       {"h", 
        StyleBox[GridBox[{
           {"j", "l"},
           {" ", " "}
          },
          GridBoxSpacings->{"Columns" -> {
              Offset[0.], {
               Offset[0.034999999999999996`]}, 
              Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
               Offset[0.]}}, "RowsIndexed" -> {}}],
         FontSize->9]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.034999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`h[$CellContext`j, $CellContext`l],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[PartialD]", "i"], GridBox[{
        {"h", 
         StyleBox[GridBox[{
            {" ", " "},
            {"k", "l"}
           },
           GridBoxSpacings->{"Columns" -> {
               Offset[0.], {
                Offset[0.034999999999999996`]}, 
               Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                Offset[0.]}}, "RowsIndexed" -> {}}],
          FontSize->9]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Center}},
          "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.034999999999999996`]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}]}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    xAct`xTensor`PD[-$CellContext`i][
     $CellContext`h[-$CellContext`k, -$CellContext`l]],
    Editable->False], " ", 
   InterpretationBox[
    StyleBox[
     RowBox[{
      SubscriptBox["\[PartialD]", "j"], "\[CurlyPhi]"}],
     ShowAutoStyles->False,
     AutoSpacing->False],
    xAct`xTensor`PD[-$CellContext`j][
     $CellContext`\[CurlyPhi][]],
    Editable->False]}]}]], "Output",
 CellChangeTimes->{
  3.617596712950409*^9, 3.61759674879908*^9, 3.617597229596406*^9, 
   3.617597353939945*^9, {3.617606660892329*^9, 3.617606684963373*^9}, 
   3.61760674578391*^9, 3.6176093130619698`*^9, 3.6185846822974997`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ByParts", "[", 
  RowBox[{"expr", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        StyleBox[GridBox[{
           {"h", 
            StyleBox[GridBox[{
               {"i", "j"},
               {" ", " "}
              },
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.], {
                   Offset[0.034999999999999996`]}, 
                  Offset[0.]}, "ColumnsIndexed" -> {}, "Rows" -> {{
                   Offset[0.]}}, "RowsIndexed" -> {}}],
             FontSize->9]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Center}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.034999999999999996`]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`h[$CellContext`i, $CellContext`j],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[PartialD]", "i"], 
          SubscriptBox["\[PartialD]", "j"], "\[CurlyPhi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        xAct`xTensor`PD[-$CellContext`i][
         xAct`xTensor`PD[-$CellContext`j][
          $CellContext`\[CurlyPhi][]]],
        Editable->False]}], ",", " ", 
      InterpretationBox[
       StyleBox[
        RowBox[{
         SubscriptBox["\[PartialD]", "i"], 
         SubscriptBox["\[PartialD]", "j"], "\[CurlyPhi]"}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       xAct`xTensor`PD[-$CellContext`i][
        xAct`xTensor`PD[-$CellContext`j][
         $CellContext`\[CurlyPhi][]]],
       Editable->False], ",", 
      RowBox[{"-", "i"}]}], "}"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.616842940540906*^9, 3.616842968775675*^9}, {
   3.61684300941394*^9, 3.616843016507594*^9}, {3.6168439654821157`*^9, 
   3.616843999120797*^9}, {3.6174238389835443`*^9, 3.6174238414302473`*^9}, {
   3.6174254856285686`*^9, 3.6174255000755796`*^9}, {3.617425536076208*^9, 
   3.617425570817708*^9}, {3.6174352564772253`*^9, 3.617435258293249*^9}, {
   3.617535126234208*^9, 3.6175351628873987`*^9}, {3.617537576939424*^9, 
   3.617537581990041*^9}, {3.617538269099112*^9, 3.617538305467205*^9}, {
   3.617538612856738*^9, 3.617538644021284*^9}, {3.617539364017521*^9, 
   3.617539385429728*^9}, {3.617539630907613*^9, 3.617539665789651*^9}, {
   3.617539837122118*^9, 3.61753989283414*^9}, {3.617540002142088*^9, 
   3.617540053358449*^9}, {3.617540158205359*^9, 3.61754018013444*^9}, {
   3.617540788938238*^9, 3.6175408235650673`*^9}, {3.617540861383713*^9, 
   3.617540877450938*^9}, {3.617544546825556*^9, 3.617544549557807*^9}, {
   3.617544593486512*^9, 3.617544632623382*^9}, {3.617545415594693*^9, 
   3.61754549490304*^9}, 3.617548541832312*^9, {3.617596911178185*^9, 
   3.61759693336604*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.617606747731901*^9, 3.617609313093298*^9, 
  3.618584682328823*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 2", "Subsection",
 CellChangeTimes->{{3.61760689225629*^9, 3.617606894143532*^9}}],

Cell["\<\
Now we do an example with a parameter derivative ParamD. These derivatives \
have no contravariant form and there is no need to specify a minus sign in \
the third argument.\
\>", "Text",
 CellChangeTimes->{{3.617607001488365*^9, 3.6176070174762917`*^9}, {
  3.6176075786117887`*^9, 3.617607650439382*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefParameter", "[", 
   RowBox[{"Time", ",", 
    RowBox[{"PrintAs", "->", "\"\<t\>\""}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.617607019822798*^9, 3.617607035167348*^9}, {
  3.617607127224511*^9, 3.617607143627047*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"\[Phi]", "[", "]"}], ",", "Time"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.617607061995727*^9, 3.617607078275362*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"\[Phi]", "[", "]"}], "]"}], 
   RowBox[{"\[Phi]", "[", "]"}], 
   RowBox[{
    RowBox[{"ParamD", "[", "Time", "]"}], "@", 
    RowBox[{"\[Phi]", "[", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6176068957017927`*^9, 3.6176069146833277`*^9}, 
   3.6176069878897448`*^9, {3.617607042657504*^9, 3.617607047145666*^9}, {
   3.6176070811044273`*^9, 3.617607086761559*^9}, 3.617607193341703*^9, 
   3.61760722644567*^9, {3.6176074746568613`*^9, 3.617607526513692*^9}, {
   3.617607557087981*^9, 3.6176075578209133`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    StyleBox["Cos",
     ShowAutoStyles->False,
     AutoSpacing->False],
    Cos,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox["\[Phi]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Phi][],
    Editable->False], "]"}], " ", 
  InterpretationBox[
   StyleBox["\[Phi]",
    ShowAutoStyles->False,
    AutoSpacing->False],
   $CellContext`\[Phi][],
   Editable->False], " ", 
  InterpretationBox[
   StyleBox[
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], "\[Phi]"}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   xAct`xTensor`ParamD[$CellContext`Time][
    $CellContext`\[Phi][]],
   Editable->False]}]], "Output",
 CellChangeTimes->{{3.617607505387809*^9, 3.617607527250209*^9}, 
   3.6176075584204273`*^9, 3.617609313167569*^9, 3.618584685151739*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ByParts", "[", 
  RowBox[{"expr", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["Cos",
          ShowAutoStyles->False,
          AutoSpacing->False],
         Cos,
         Editable->False], "[", 
        InterpretationBox[
         StyleBox["\[Phi]",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`\[Phi][],
         Editable->False], "]"}], " ", 
       InterpretationBox[
        StyleBox["\[Phi]",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`\[Phi][],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox[
         RowBox[{
          SubscriptBox["\[PartialD]", "t"], "\[Phi]"}],
         ShowAutoStyles->False,
         AutoSpacing->False],
        xAct`xTensor`ParamD[$CellContext`Time][
         $CellContext`\[Phi][]],
        Editable->False]}], ",", 
      InterpretationBox[
       StyleBox[
        RowBox[{
         SubscriptBox["\[PartialD]", "t"], "\[Phi]"}],
        ShowAutoStyles->False,
        AutoSpacing->False],
       xAct`xTensor`ParamD[$CellContext`Time][
        $CellContext`\[Phi][]],
       Editable->False], ",", "Time"}], "}"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.617606923022965*^9, 3.61760692427439*^9}, {
  3.617607230818988*^9, 3.617607256860952*^9}, {3.617607428977539*^9, 
  3.6176074579195623`*^9}, {3.617607535470909*^9, 3.61760756450697*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{
   InterpretationBox[
    StyleBox["Sin",
     ShowAutoStyles->False,
     AutoSpacing->False],
    Sin,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox["\[Phi]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Phi][],
    Editable->False], "]"}], " ", 
  SuperscriptBox[
   InterpretationBox[
    StyleBox["\[Phi]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Phi][],
    Editable->False], "2"], " ", 
  InterpretationBox[
   StyleBox[
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], "\[Phi]"}],
    ShowAutoStyles->False,
    AutoSpacing->False],
   xAct`xTensor`ParamD[$CellContext`Time][
    $CellContext`\[Phi][]],
   Editable->False]}]], "Output",
 CellChangeTimes->{
  3.6176072581287117`*^9, {3.61760744222563*^9, 3.617607458270187*^9}, {
   3.617607541416876*^9, 3.6176075666211357`*^9}, 3.617609313194087*^9, 
   3.618584685459886*^9}]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1182, 857},
WindowMargins->{{Automatic, 128}, {Automatic, 39}},
ShowSelection->True,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Title"], TextAlignment -> Center, FontFamily -> "Palatino", 
    FontSize -> 44, FontWeight -> "Plain", FontSlant -> "Plain", FontColor -> 
    GrayLevel[0]], 
   Cell[
    StyleData["Section"], CellDingbat -> None, ShowGroupOpener -> True, 
    FontFamily -> "Palatino", FontSize -> 16, FontWeight -> "Plain", 
    FontSlant -> "Plain", FontColor -> GrayLevel[0]], 
   Cell[
    StyleData["Text"], TextAlignment -> Left, FontFamily -> "Palatino", 
    FontSize -> 12, FontWeight -> "Plain", FontSlant -> "Plain"], 
   Cell[
    StyleData["Subsection"], FontFamily -> "Palatino Italic", FontSize -> 14, 
    FontWeight -> "Plain", FontSlant -> "Plain", FontColor -> GrayLevel[0]], 
   Cell[
    StyleData["Code"], FontSize -> 12], 
   Cell[
    StyleData["Subtitle"], FontFamily -> "Palatino", FontSize -> 30, 
    FontWeight -> "Plain", FontSlant -> "Plain", FontColor -> GrayLevel[0]], 
   Cell[
    StyleData["Subsubsection"], FontFamily -> "Palatino Bold", FontSize -> 14,
     FontWeight -> "Plain", FontSlant -> "Plain", FontColor -> 
    RGBColor[0.6, 0.4, 0.2]], 
   Cell[
    StyleData["Item"], FontFamily -> "Palatino", FontSize -> 12, FontWeight -> 
    "Plain", FontSlant -> "Plain"], 
   Cell[
    StyleData["Input"], FontSize -> 12]}, Visible -> False, FrontEndVersion -> 
  "9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, 2013)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 154, 2, 90, "Title"],
Cell[736, 26, 459, 8, 45, "Text"],
Cell[CellGroupData[{
Cell[1220, 38, 1009, 14, 29, "Input"],
Cell[CellGroupData[{
Cell[2254, 56, 1588, 23, 21, "Print"],
Cell[3845, 81, 1859, 31, 22, "Print"],
Cell[5707, 114, 1609, 23, 22, "Print"],
Cell[7319, 139, 1566, 22, 22, "Print"],
Cell[8888, 163, 1551, 22, 21, "Print"],
Cell[10442, 187, 1587, 23, 21, "Print"],
Cell[12032, 212, 1864, 31, 22, "Print"],
Cell[13899, 245, 1608, 23, 22, "Print"],
Cell[15510, 270, 1588, 23, 21, "Print"],
Cell[17101, 295, 1857, 30, 22, "Print"],
Cell[18961, 327, 1608, 23, 22, "Print"],
Cell[20572, 352, 1555, 22, 22, "Print"],
Cell[22130, 376, 1588, 23, 21, "Print"],
Cell[23721, 401, 1743, 25, 38, "Print"],
Cell[25467, 428, 1590, 23, 21, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27106, 457, 192, 4, 36, "Subsection"],
Cell[CellGroupData[{
Cell[27323, 465, 113, 1, 29, "Input"],
Cell[27439, 468, 4807, 66, 794, "Output"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32295, 540, 205, 4, 66, "Section"],
Cell[32503, 546, 392, 6, 49, "Text"],
Cell[CellGroupData[{
Cell[32920, 556, 255, 3, 36, "Subsection"],
Cell[33178, 561, 515, 8, 68, "Text"],
Cell[33696, 571, 752, 20, 61, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[34485, 596, 199, 3, 28, "Subsection"],
Cell[34687, 601, 208, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[34920, 609, 545, 13, 29, "Input"],
Cell[35468, 624, 918, 25, 33, "Output"]
}, Open  ]],
Cell[36401, 652, 188, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[36614, 658, 2301, 51, 33, "Input"],
Cell[38918, 711, 645, 22, 33, "Output"]
}, Open  ]],
Cell[39578, 736, 384, 7, 49, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[39999, 748, 249, 4, 28, "Subsection"],
Cell[40251, 754, 220, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[40496, 762, 519, 11, 29, "Input"],
Cell[41018, 775, 713, 17, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41768, 797, 1382, 38, 33, "Input"],
Cell[43153, 837, 219, 4, 28, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[43421, 847, 299, 4, 28, "Subsection"],
Cell[43723, 853, 228, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[43976, 862, 738, 17, 31, "Input"],
Cell[44717, 881, 1171, 33, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45925, 919, 1783, 51, 33, "Input"],
Cell[47711, 972, 858, 26, 48, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[48618, 1004, 313, 4, 28, "Subsection"],
Cell[48934, 1010, 267, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[49226, 1019, 740, 17, 31, "Input"],
Cell[49969, 1038, 1171, 33, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51177, 1076, 1375, 43, 33, "Input"],
Cell[52555, 1121, 706, 23, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53298, 1149, 3009, 87, 47, "Input"],
Cell[56310, 1238, 1032, 31, 33, "Output"]
}, Open  ]],
Cell[57357, 1272, 947, 15, 125, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[58341, 1292, 372, 5, 28, "Subsection"],
Cell[58716, 1299, 925, 14, 87, "Text"],
Cell[CellGroupData[{
Cell[59666, 1317, 1025, 22, 29, "Input"],
Cell[60694, 1341, 2026, 52, 33, "Output"]
}, Open  ]],
Cell[62735, 1396, 261, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[63021, 1405, 3875, 87, 35, "Input"],
Cell[66899, 1494, 1698, 48, 33, "Output"]
}, Open  ]],
Cell[68612, 1545, 303, 5, 49, "Text"],
Cell[CellGroupData[{
Cell[68940, 1554, 3922, 88, 35, "Input"],
Cell[72865, 1644, 4438, 124, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77340, 1773, 2514, 69, 35, "Input"],
Cell[79857, 1844, 4165, 119, 33, "Output"]
}, Open  ]],
Cell[84037, 1966, 205, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[84267, 1974, 741, 23, 29, "Input"],
Cell[85011, 1999, 1846, 53, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86894, 2057, 2957, 79, 35, "Input"],
Cell[89854, 2138, 15662, 444, 57, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[105577, 2589, 262, 5, 36, "Section"],
Cell[105842, 2596, 691, 10, 87, "Text"],
Cell[CellGroupData[{
Cell[106558, 2610, 402, 7, 36, "Subsection"],
Cell[106963, 2619, 327, 5, 49, "Text"],
Cell[107293, 2626, 235, 6, 29, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[107565, 2637, 231, 3, 28, "Subsection"],
Cell[107799, 2642, 185, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[108009, 2650, 507, 11, 29, "Input"],
Cell[108519, 2663, 939, 20, 33, "Output"]
}, Open  ]],
Cell[109473, 2686, 247, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[109745, 2695, 262, 7, 29, "Input"],
Cell[110010, 2704, 4934, 142, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114981, 2851, 3186, 74, 35, "Input"],
Cell[118170, 2927, 117, 2, 28, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[118336, 2935, 96, 1, 28, "Subsection"],
Cell[118435, 2938, 316, 6, 49, "Text"],
Cell[118754, 2946, 265, 6, 28, "Input"],
Cell[119022, 2954, 203, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[119250, 2963, 600, 13, 29, "Input"],
Cell[119853, 2978, 869, 31, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120759, 3014, 1506, 46, 29, "Input"],
Cell[122268, 3062, 984, 35, 47, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
